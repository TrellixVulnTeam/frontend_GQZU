{"version":3,"file":"katoid-angular-grid-layout.js","sources":["../../../projects/angular-grid-layout/src/lib/utils/react-grid-layout.utils.ts","../../../projects/angular-grid-layout/src/lib/utils/passive-listeners.ts","../../../projects/angular-grid-layout/src/lib/utils/pointer.utils.ts","../../../projects/angular-grid-layout/src/lib/utils/grid.utils.ts","../../../projects/angular-grid-layout/src/lib/directives/drag-handle.ts","../../../projects/angular-grid-layout/src/lib/directives/resize-handle.ts","../../../projects/angular-grid-layout/src/lib/grid.definitions.ts","../../../projects/angular-grid-layout/src/lib/utils/operators.ts","../../../projects/angular-grid-layout/src/lib/coercion/boolean-property.ts","../../../projects/angular-grid-layout/src/lib/coercion/number-property.ts","../../../projects/angular-grid-layout/src/lib/grid.service.ts","../../../projects/angular-grid-layout/src/lib/grid-item/grid-item.component.ts","../../../projects/angular-grid-layout/src/lib/grid-item/grid-item.component.html","../../../projects/angular-grid-layout/src/lib/utils/client-rect.ts","../../../projects/angular-grid-layout/src/lib/utils/scroll.ts","../../../projects/angular-grid-layout/src/lib/grid.component.ts","../../../projects/angular-grid-layout/src/lib/grid.component.html","../../../projects/angular-grid-layout/src/lib/grid.module.ts","../../../projects/angular-grid-layout/src/public-api.ts","../../../projects/angular-grid-layout/src/katoid-angular-grid-layout.ts"],"sourcesContent":["\r\n/**\r\n * IMPORTANT:\r\n * This utils are taken from the project: https://github.com/STRML/react-grid-layout.\r\n * The code should be as less modified as possible for easy maintenance.\r\n */\r\n\r\n// Disable lint since we don't want to modify this code\r\n// tslint:disable\r\nexport type LayoutItem = {\r\n    w: number;\r\n    h: number;\r\n    x: number;\r\n    y: number;\r\n    id: string;\r\n    minW?: number;\r\n    minH?: number;\r\n    maxW?: number;\r\n    maxH?: number;\r\n    moved?: boolean;\r\n    static?: boolean;\r\n    isDraggable?: boolean | null | undefined;\r\n    isResizable?: boolean | null | undefined;\r\n};\r\nexport type Layout = Array<LayoutItem>;\r\nexport type Position = {\r\n    left: number;\r\n    top: number;\r\n    width: number;\r\n    height: number;\r\n};\r\nexport type ReactDraggableCallbackData = {\r\n    node: HTMLElement;\r\n    x?: number;\r\n    y?: number;\r\n    deltaX: number;\r\n    deltaY: number;\r\n    lastX?: number;\r\n    lastY?: number;\r\n};\r\n\r\nexport type PartialPosition = { left: number; top: number };\r\nexport type DroppingPosition = { x: number; y: number; e: Event };\r\nexport type Size = { width: number; height: number };\r\nexport type GridDragEvent = {\r\n    e: Event;\r\n    node: HTMLElement;\r\n    newPosition: PartialPosition;\r\n};\r\nexport type GridResizeEvent = { e: Event; node: HTMLElement; size: Size };\r\nexport type DragOverEvent = MouseEvent & {\r\n    nativeEvent: {\r\n        layerX: number;\r\n        layerY: number;\r\n        target: {\r\n            className: String;\r\n        };\r\n    };\r\n};\r\n\r\n//type REl = ReactElement<any>;\r\n//export type ReactChildren = ReactChildrenArray<REl>;\r\n\r\n// All callbacks are of the signature (layout, oldItem, newItem, placeholder, e).\r\nexport type EventCallback = (\r\n    arg0: Layout,\r\n    oldItem: LayoutItem | null | undefined,\r\n    newItem: LayoutItem | null | undefined,\r\n    placeholder: LayoutItem | null | undefined,\r\n    arg4: Event,\r\n    arg5: HTMLElement | null | undefined,\r\n) => void;\r\nexport type CompactType = ('horizontal' | 'vertical') | null | undefined;\r\n\r\nconst DEBUG = false;\r\n\r\n/**\r\n * Return the bottom coordinate of the layout.\r\n *\r\n * @param  {Array} layout Layout array.\r\n * @return {Number}       Bottom coordinate.\r\n */\r\nexport function bottom(layout: Layout): number {\r\n    let max = 0,\r\n        bottomY;\r\n    for (let i = 0, len = layout.length; i < len; i++) {\r\n        bottomY = layout[i].y + layout[i].h;\r\n        if (bottomY > max) {\r\n            max = bottomY;\r\n        }\r\n    }\r\n    return max;\r\n}\r\n\r\nexport function cloneLayout(layout: Layout): Layout {\r\n    const newLayout = Array(layout.length);\r\n    for (let i = 0, len = layout.length; i < len; i++) {\r\n        newLayout[i] = cloneLayoutItem(layout[i]);\r\n    }\r\n    return newLayout;\r\n}\r\n\r\n// Fast path to cloning, since this is monomorphic\r\n/** NOTE: This code has been modified from the original source */\r\nexport function cloneLayoutItem(layoutItem: LayoutItem): LayoutItem {\r\n    const clonedLayoutItem: LayoutItem = {\r\n        w: layoutItem.w,\r\n        h: layoutItem.h,\r\n        x: layoutItem.x,\r\n        y: layoutItem.y,\r\n        id: layoutItem.id,\r\n        moved: !!layoutItem.moved,\r\n        static: !!layoutItem.static,\r\n    };\r\n\r\n    if (layoutItem.minW !== undefined) { clonedLayoutItem.minW = layoutItem.minW;}\r\n    if (layoutItem.maxW !== undefined) { clonedLayoutItem.maxW = layoutItem.maxW;}\r\n    if (layoutItem.minH !== undefined) { clonedLayoutItem.minH = layoutItem.minH;}\r\n    if (layoutItem.maxH !== undefined) { clonedLayoutItem.maxH = layoutItem.maxH;}\r\n    // These can be null\r\n    if (layoutItem.isDraggable !== undefined) { clonedLayoutItem.isDraggable = layoutItem.isDraggable;}\r\n    if (layoutItem.isResizable !== undefined) { clonedLayoutItem.isResizable = layoutItem.isResizable;}\r\n\r\n    return clonedLayoutItem;\r\n}\r\n\r\n/**\r\n * Given two layoutitems, check if they collide.\r\n */\r\nexport function collides(l1: LayoutItem, l2: LayoutItem): boolean {\r\n    if (l1.id === l2.id) {\r\n        return false;\r\n    } // same element\r\n    if (l1.x + l1.w <= l2.x) {\r\n        return false;\r\n    } // l1 is left of l2\r\n    if (l1.x >= l2.x + l2.w) {\r\n        return false;\r\n    } // l1 is right of l2\r\n    if (l1.y + l1.h <= l2.y) {\r\n        return false;\r\n    } // l1 is above l2\r\n    if (l1.y >= l2.y + l2.h) {\r\n        return false;\r\n    } // l1 is below l2\r\n    return true; // boxes overlap\r\n}\r\n\r\n/**\r\n * Given a layout, compact it. This involves going down each y coordinate and removing gaps\r\n * between items.\r\n *\r\n * @param  {Array} layout Layout.\r\n * @param  {Boolean} verticalCompact Whether or not to compact the layout\r\n *   vertically.\r\n * @return {Array}       Compacted Layout.\r\n */\r\nexport function compact(\r\n    layout: Layout,\r\n    compactType: CompactType,\r\n    cols: number,\r\n): Layout {\r\n    // Statics go in the compareWith array right away so items flow around them.\r\n    const compareWith = getStatics(layout);\r\n    // We go through the items by row and column.\r\n    const sorted = sortLayoutItems(layout, compactType);\r\n    // Holding for new items.\r\n    const out = Array(layout.length);\r\n\r\n    for (let i = 0, len = sorted.length; i < len; i++) {\r\n        let l = cloneLayoutItem(sorted[i]);\r\n\r\n        // Don't move static elements\r\n        if (!l.static) {\r\n            l = compactItem(compareWith, l, compactType, cols, sorted);\r\n\r\n            // Add to comparison array. We only collide with items before this one.\r\n            // Statics are already in this array.\r\n            compareWith.push(l);\r\n        }\r\n\r\n        // Add to output array to make sure they still come out in the right order.\r\n        out[layout.indexOf(sorted[i])] = l;\r\n\r\n        // Clear moved flag, if it exists.\r\n        l.moved = false;\r\n    }\r\n\r\n    return out;\r\n}\r\n\r\nconst heightWidth = {x: 'w', y: 'h'};\r\n\r\n/**\r\n * Before moving item down, it will check if the movement will cause collisions and move those items down before.\r\n */\r\nfunction resolveCompactionCollision(\r\n    layout: Layout,\r\n    item: LayoutItem,\r\n    moveToCoord: number,\r\n    axis: 'x' | 'y',\r\n) {\r\n    const sizeProp = heightWidth[axis];\r\n    item[axis] += 1;\r\n    const itemIndex = layout\r\n        .map(layoutItem => {\r\n            return layoutItem.id;\r\n        })\r\n        .indexOf(item.id);\r\n\r\n    // Go through each item we collide with.\r\n    for (let i = itemIndex + 1; i < layout.length; i++) {\r\n        const otherItem = layout[i];\r\n        // Ignore static items\r\n        if (otherItem.static) {\r\n            continue;\r\n        }\r\n\r\n        // Optimization: we can break early if we know we're past this el\r\n        // We can do this b/c it's a sorted layout\r\n        if (otherItem.y > item.y + item.h) {\r\n            break;\r\n        }\r\n\r\n        if (collides(item, otherItem)) {\r\n            resolveCompactionCollision(\r\n                layout,\r\n                otherItem,\r\n                moveToCoord + item[sizeProp],\r\n                axis,\r\n            );\r\n        }\r\n    }\r\n\r\n    item[axis] = moveToCoord;\r\n}\r\n\r\n/**\r\n * Compact an item in the layout.\r\n */\r\nexport function compactItem(\r\n    compareWith: Layout,\r\n    l: LayoutItem,\r\n    compactType: CompactType,\r\n    cols: number,\r\n    fullLayout: Layout,\r\n): LayoutItem {\r\n    const compactV = compactType === 'vertical';\r\n    const compactH = compactType === 'horizontal';\r\n    if (compactV) {\r\n        // Bottom 'y' possible is the bottom of the layout.\r\n        // This allows you to do nice stuff like specify {y: Infinity}\r\n        // This is here because the layout must be sorted in order to get the correct bottom `y`.\r\n        l.y = Math.min(bottom(compareWith), l.y);\r\n        // Move the element up as far as it can go without colliding.\r\n        while (l.y > 0 && !getFirstCollision(compareWith, l)) {\r\n            l.y--;\r\n        }\r\n    } else if (compactH) {\r\n        l.y = Math.min(bottom(compareWith), l.y);\r\n        // Move the element left as far as it can go without colliding.\r\n        while (l.x > 0 && !getFirstCollision(compareWith, l)) {\r\n            l.x--;\r\n        }\r\n    }\r\n\r\n    // Move it down, and keep moving it down if it's colliding.\r\n    let collides;\r\n    while ((collides = getFirstCollision(compareWith, l))) {\r\n        if (compactH) {\r\n            resolveCompactionCollision(\r\n                fullLayout,\r\n                l,\r\n                collides.x + collides.w,\r\n                'x',\r\n            );\r\n        } else {\r\n            resolveCompactionCollision(\r\n                fullLayout,\r\n                l,\r\n                collides.y + collides.h,\r\n                'y',\r\n            );\r\n        }\r\n        // Since we can't grow without bounds horizontally, if we've overflown, let's move it down and try again.\r\n        if (compactH && l.x + l.w > cols) {\r\n            l.x = cols - l.w;\r\n            l.y++;\r\n        }\r\n    }\r\n    return l;\r\n}\r\n\r\n/**\r\n * Given a layout, make sure all elements fit within its bounds.\r\n *\r\n * @param  {Array} layout Layout array.\r\n * @param  {Number} bounds Number of columns.\r\n */\r\nexport function correctBounds(layout: Layout, bounds: { cols: number }): Layout {\r\n    const collidesWith = getStatics(layout);\r\n    for (let i = 0, len = layout.length; i < len; i++) {\r\n        const l = layout[i];\r\n        // Overflows right\r\n        if (l.x + l.w > bounds.cols) {\r\n            l.x = bounds.cols - l.w;\r\n        }\r\n        // Overflows left\r\n        if (l.x < 0) {\r\n            l.x = 0;\r\n            l.w = bounds.cols;\r\n        }\r\n        if (!l.static) {\r\n            collidesWith.push(l);\r\n        } else {\r\n            // If this is static and collides with other statics, we must move it down.\r\n            // We have to do something nicer than just letting them overlap.\r\n            while (getFirstCollision(collidesWith, l)) {\r\n                l.y++;\r\n            }\r\n        }\r\n    }\r\n    return layout;\r\n}\r\n\r\n/**\r\n * Get a layout item by ID. Used so we can override later on if necessary.\r\n *\r\n * @param  {Array}  layout Layout array.\r\n * @param  {String} id     ID\r\n * @return {LayoutItem}    Item at ID.\r\n */\r\nexport function getLayoutItem(\r\n    layout: Layout,\r\n    id: string,\r\n): LayoutItem | null | undefined {\r\n    for (let i = 0, len = layout.length; i < len; i++) {\r\n        if (layout[i].id === id) {\r\n            return layout[i];\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * Returns the first item this layout collides with.\r\n * It doesn't appear to matter which order we approach this from, although\r\n * perhaps that is the wrong thing to do.\r\n *\r\n * @param  {Object} layoutItem Layout item.\r\n * @return {Object|undefined}  A colliding layout item, or undefined.\r\n */\r\nexport function getFirstCollision(\r\n    layout: Layout,\r\n    layoutItem: LayoutItem,\r\n): LayoutItem | null | undefined {\r\n    for (let i = 0, len = layout.length; i < len; i++) {\r\n        if (collides(layout[i], layoutItem)) {\r\n            return layout[i];\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nexport function getAllCollisions(\r\n    layout: Layout,\r\n    layoutItem: LayoutItem,\r\n): Array<LayoutItem> {\r\n    return layout.filter(l => collides(l, layoutItem));\r\n}\r\n\r\n/**\r\n * Get all static elements.\r\n * @param  {Array} layout Array of layout objects.\r\n * @return {Array}        Array of static layout items..\r\n */\r\nexport function getStatics(layout: Layout): Array<LayoutItem> {\r\n    return layout.filter(l => l.static);\r\n}\r\n\r\n/**\r\n * Move an element. Responsible for doing cascading movements of other elements.\r\n *\r\n * @param  {Array}      layout            Full layout to modify.\r\n * @param  {LayoutItem} l                 element to move.\r\n * @param  {Number}     [x]               X position in grid units.\r\n * @param  {Number}     [y]               Y position in grid units.\r\n */\r\nexport function moveElement(\r\n    layout: Layout,\r\n    l: LayoutItem,\r\n    x: number | null | undefined,\r\n    y: number | null | undefined,\r\n    isUserAction: boolean | null | undefined,\r\n    preventCollision: boolean | null | undefined,\r\n    compactType: CompactType,\r\n    cols: number,\r\n): Layout {\r\n    // If this is static and not explicitly enabled as draggable,\r\n    // no move is possible, so we can short-circuit this immediately.\r\n    if (l.static && l.isDraggable !== true) {\r\n        return layout;\r\n    }\r\n\r\n    // Short-circuit if nothing to do.\r\n    if (l.y === y && l.x === x) {\r\n        return layout;\r\n    }\r\n\r\n    log(\r\n        `Moving element ${l.id} to [${String(x)},${String(y)}] from [${l.x},${\r\n            l.y\r\n        }]`,\r\n    );\r\n    const oldX = l.x;\r\n    const oldY = l.y;\r\n\r\n    // This is quite a bit faster than extending the object\r\n    if (typeof x === 'number') {\r\n        l.x = x;\r\n    }\r\n    if (typeof y === 'number') {\r\n        l.y = y;\r\n    }\r\n    l.moved = true;\r\n\r\n    // If this collides with anything, move it.\r\n    // When doing this comparison, we have to sort the items we compare with\r\n    // to ensure, in the case of multiple collisions, that we're getting the\r\n    // nearest collision.\r\n    let sorted = sortLayoutItems(layout, compactType);\r\n    const movingUp =\r\n        compactType === 'vertical' && typeof y === 'number'\r\n            ? oldY >= y\r\n            : compactType === 'horizontal' && typeof x === 'number'\r\n            ? oldX >= x\r\n            : false;\r\n    if (movingUp) {\r\n        sorted = sorted.reverse();\r\n    }\r\n    const collisions = getAllCollisions(sorted, l);\r\n\r\n    // There was a collision; abort\r\n    if (preventCollision && collisions.length) {\r\n        log(`Collision prevented on ${l.id}, reverting.`);\r\n        l.x = oldX;\r\n        l.y = oldY;\r\n        l.moved = false;\r\n        return layout;\r\n    }\r\n\r\n    // Move each item that collides away from this element.\r\n    for (let i = 0, len = collisions.length; i < len; i++) {\r\n        const collision = collisions[i];\r\n        log(\r\n            `Resolving collision between ${l.id} at [${l.x},${l.y}] and ${\r\n                collision.id\r\n            } at [${collision.x},${collision.y}]`,\r\n        );\r\n\r\n        // Short circuit so we can't infinite loop\r\n        if (collision.moved) {\r\n            continue;\r\n        }\r\n\r\n        // Don't move static items - we have to move *this* element away\r\n        if (collision.static) {\r\n            layout = moveElementAwayFromCollision(\r\n                layout,\r\n                collision,\r\n                l,\r\n                isUserAction,\r\n                compactType,\r\n                cols,\r\n            );\r\n        } else {\r\n            layout = moveElementAwayFromCollision(\r\n                layout,\r\n                l,\r\n                collision,\r\n                isUserAction,\r\n                compactType,\r\n                cols,\r\n            );\r\n        }\r\n    }\r\n\r\n    return layout;\r\n}\r\n\r\n/**\r\n * This is where the magic needs to happen - given a collision, move an element away from the collision.\r\n * We attempt to move it up if there's room, otherwise it goes below.\r\n *\r\n * @param  {Array} layout            Full layout to modify.\r\n * @param  {LayoutItem} collidesWith Layout item we're colliding with.\r\n * @param  {LayoutItem} itemToMove   Layout item we're moving.\r\n */\r\nexport function moveElementAwayFromCollision(\r\n    layout: Layout,\r\n    collidesWith: LayoutItem,\r\n    itemToMove: LayoutItem,\r\n    isUserAction: boolean | null | undefined,\r\n    compactType: CompactType,\r\n    cols: number,\r\n): Layout {\r\n    const compactH = compactType === 'horizontal';\r\n    // Compact vertically if not set to horizontal\r\n    const compactV = compactType !== 'horizontal';\r\n    const preventCollision = collidesWith.static; // we're already colliding (not for static items)\r\n\r\n    // If there is enough space above the collision to put this element, move it there.\r\n    // We only do this on the main collision as this can get funky in cascades and cause\r\n    // unwanted swapping behavior.\r\n    if (isUserAction) {\r\n        // Reset isUserAction flag because we're not in the main collision anymore.\r\n        isUserAction = false;\r\n\r\n        // Make a mock item so we don't modify the item here, only modify in moveElement.\r\n        const fakeItem: LayoutItem = {\r\n            x: compactH\r\n                ? Math.max(collidesWith.x - itemToMove.w, 0)\r\n                : itemToMove.x,\r\n            y: compactV\r\n                ? Math.max(collidesWith.y - itemToMove.h, 0)\r\n                : itemToMove.y,\r\n            w: itemToMove.w,\r\n            h: itemToMove.h,\r\n            id: '-1',\r\n        };\r\n\r\n        // No collision? If so, we can go up there; otherwise, we'll end up moving down as normal\r\n        if (!getFirstCollision(layout, fakeItem)) {\r\n            log(\r\n                `Doing reverse collision on ${itemToMove.id} up to [${\r\n                    fakeItem.x\r\n                },${fakeItem.y}].`,\r\n            );\r\n            return moveElement(\r\n                layout,\r\n                itemToMove,\r\n                compactH ? fakeItem.x : undefined,\r\n                compactV ? fakeItem.y : undefined,\r\n                isUserAction,\r\n                preventCollision,\r\n                compactType,\r\n                cols,\r\n            );\r\n        }\r\n    }\r\n\r\n    return moveElement(\r\n        layout,\r\n        itemToMove,\r\n        compactH ? itemToMove.x + 1 : undefined,\r\n        compactV ? itemToMove.y + 1 : undefined,\r\n        isUserAction,\r\n        preventCollision,\r\n        compactType,\r\n        cols,\r\n    );\r\n}\r\n\r\n/**\r\n * Helper to convert a number to a percentage string.\r\n *\r\n * @param  {Number} num Any number\r\n * @return {String}     That number as a percentage.\r\n */\r\nexport function perc(num: number): string {\r\n    return num * 100 + '%';\r\n}\r\n\r\nexport function setTransform({top, left, width, height}: Position): Object {\r\n    // Replace unitless items with px\r\n    const translate = `translate(${left}px,${top}px)`;\r\n    return {\r\n        transform: translate,\r\n        WebkitTransform: translate,\r\n        MozTransform: translate,\r\n        msTransform: translate,\r\n        OTransform: translate,\r\n        width: `${width}px`,\r\n        height: `${height}px`,\r\n        position: 'absolute',\r\n    };\r\n}\r\n\r\nexport function setTopLeft({top, left, width, height}: Position): Object {\r\n    return {\r\n        top: `${top}px`,\r\n        left: `${left}px`,\r\n        width: `${width}px`,\r\n        height: `${height}px`,\r\n        position: 'absolute',\r\n    };\r\n}\r\n\r\n/**\r\n * Get layout items sorted from top left to right and down.\r\n *\r\n * @return {Array} Array of layout objects.\r\n * @return {Array}        Layout, sorted static items first.\r\n */\r\nexport function sortLayoutItems(\r\n    layout: Layout,\r\n    compactType: CompactType,\r\n): Layout {\r\n    if (compactType === 'horizontal') {\r\n        return sortLayoutItemsByColRow(layout);\r\n    } else {\r\n        return sortLayoutItemsByRowCol(layout);\r\n    }\r\n}\r\n\r\nexport function sortLayoutItemsByRowCol(layout: Layout): Layout {\r\n    return ([] as any[]).concat(layout).sort(function (a, b) {\r\n        if (a.y > b.y || (a.y === b.y && a.x > b.x)) {\r\n            return 1;\r\n        } else if (a.y === b.y && a.x === b.x) {\r\n            // Without this, we can get different sort results in IE vs. Chrome/FF\r\n            return 0;\r\n        }\r\n        return -1;\r\n    });\r\n}\r\n\r\nexport function sortLayoutItemsByColRow(layout: Layout): Layout {\r\n    return ([] as any[]).concat(layout).sort(function (a, b) {\r\n        if (a.x > b.x || (a.x === b.x && a.y > b.y)) {\r\n            return 1;\r\n        }\r\n        return -1;\r\n    });\r\n}\r\n\r\n/**\r\n * Validate a layout. Throws errors.\r\n *\r\n * @param  {Array}  layout        Array of layout items.\r\n * @param  {String} [contextName] Context name for errors.\r\n * @throw  {Error}                Validation error.\r\n */\r\nexport function validateLayout(\r\n    layout: Layout,\r\n    contextName: string = 'Layout',\r\n): void {\r\n    const subProps = ['x', 'y', 'w', 'h'];\r\n    if (!Array.isArray(layout)) {\r\n        throw new Error(contextName + ' must be an array!');\r\n    }\r\n    for (let i = 0, len = layout.length; i < len; i++) {\r\n        const item = layout[i];\r\n        for (let j = 0; j < subProps.length; j++) {\r\n            if (typeof item[subProps[j]] !== 'number') {\r\n                throw new Error(\r\n                    'ReactGridLayout: ' +\r\n                    contextName +\r\n                    '[' +\r\n                    i +\r\n                    '].' +\r\n                    subProps[j] +\r\n                    ' must be a number!',\r\n                );\r\n            }\r\n        }\r\n        if (item.id && typeof item.id !== 'string') {\r\n            throw new Error(\r\n                'ReactGridLayout: ' +\r\n                contextName +\r\n                '[' +\r\n                i +\r\n                '].i must be a string!',\r\n            );\r\n        }\r\n        if (item.static !== undefined && typeof item.static !== 'boolean') {\r\n            throw new Error(\r\n                'ReactGridLayout: ' +\r\n                contextName +\r\n                '[' +\r\n                i +\r\n                '].static must be a boolean!',\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\n// Flow can't really figure this out, so we just use Object\r\nexport function autoBindHandlers(el: Object, fns: Array<string>): void {\r\n    fns.forEach(key => (el[key] = el[key].bind(el)));\r\n}\r\n\r\nfunction log(...args) {\r\n    if (!DEBUG) {\r\n        return;\r\n    }\r\n    // eslint-disable-next-line no-console\r\n    console.log(...args);\r\n}\r\n\r\nexport const noop = () => {};\r\n","/** Cached result of whether the user's browser supports passive event listeners. */\r\nlet supportsPassiveEvents: boolean;\r\n\r\n/**\r\n * Checks whether the user's browser supports passive event listeners.\r\n * See: https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\r\n */\r\nexport function ktdSupportsPassiveEventListeners(): boolean {\r\n    if (supportsPassiveEvents == null && typeof window !== 'undefined') {\r\n        try {\r\n            window.addEventListener('test', null!, Object.defineProperty({}, 'passive', {\r\n                get: () => supportsPassiveEvents = true\r\n            }));\r\n        } finally {\r\n            supportsPassiveEvents = supportsPassiveEvents || false;\r\n        }\r\n    }\r\n\r\n    return supportsPassiveEvents;\r\n}\r\n\r\n/**\r\n * Normalizes an `AddEventListener` object to something that can be passed\r\n * to `addEventListener` on any browser, no matter whether it supports the\r\n * `options` parameter.\r\n * @param options Object to be normalized.\r\n */\r\nexport function ktdNormalizePassiveListenerOptions(options: AddEventListenerOptions):\r\n    AddEventListenerOptions | boolean {\r\n    return ktdSupportsPassiveEventListeners() ? options : !!options.capture;\r\n}\r\n","import { fromEvent, iif, merge, Observable } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { ktdNormalizePassiveListenerOptions } from './passive-listeners';\r\n\r\n/** Options that can be used to bind a passive event listener. */\r\nconst passiveEventListenerOptions = ktdNormalizePassiveListenerOptions({passive: true});\r\n\r\n/** Options that can be used to bind an active event listener. */\r\nconst activeEventListenerOptions = ktdNormalizePassiveListenerOptions({passive: false});\r\n\r\nlet isMobile: boolean | null = null;\r\n\r\nexport function ktdIsMobileOrTablet(): boolean {\r\n\r\n    if (isMobile != null) {\r\n        return isMobile;\r\n    }\r\n\r\n    // Generic match pattern to identify mobile or tablet devices\r\n    const isMobileDevice = /Android|webOS|BlackBerry|Windows Phone|iPad|iPhone|iPod/i.test(navigator.userAgent);\r\n\r\n    // Since IOS 13 is not safe to just check for the generic solution. See: https://stackoverflow.com/questions/58019463/how-to-detect-device-name-in-safari-on-ios-13-while-it-doesnt-show-the-correct\r\n    const isIOSMobileDevice = /iPad|iPhone|iPod/.test(navigator.platform) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);\r\n\r\n    isMobile = isMobileDevice || isIOSMobileDevice;\r\n\r\n    return isMobile;\r\n}\r\n\r\nexport function ktdIsMouseEvent(event: any): event is MouseEvent {\r\n    return (event as MouseEvent).clientX != null;\r\n}\r\n\r\nexport function ktdIsTouchEvent(event: any): event is TouchEvent {\r\n    return (event as TouchEvent).touches != null && (event as TouchEvent).touches.length != null;\r\n}\r\n\r\nexport function ktdPointerClientX(event: MouseEvent | TouchEvent): number {\r\n    return ktdIsMouseEvent(event) ? event.clientX : event.touches[0].clientX;\r\n}\r\n\r\nexport function ktdPointerClientY(event: MouseEvent | TouchEvent): number {\r\n    return ktdIsMouseEvent(event) ? event.clientY : event.touches[0].clientY;\r\n}\r\n\r\nexport function ktdPointerClient(event: MouseEvent | TouchEvent): {clientX: number, clientY: number} {\r\n    return  {\r\n        clientX: ktdIsMouseEvent(event) ? event.clientX : event.touches[0].clientX,\r\n        clientY: ktdIsMouseEvent(event) ? event.clientY : event.touches[0].clientY\r\n    };\r\n}\r\n\r\n/**\r\n * Emits when a mousedown or touchstart emits. Avoids conflicts between both events.\r\n * @param element, html element where to  listen the events.\r\n * @param touchNumber number of the touch to track the event, default to the first one.\r\n */\r\nexport function ktdMouseOrTouchDown(element, touchNumber = 1): Observable<MouseEvent | TouchEvent> {\r\n    return iif(\r\n        () => ktdIsMobileOrTablet(),\r\n        fromEvent<TouchEvent>(element, 'touchstart', passiveEventListenerOptions as AddEventListenerOptions).pipe(\r\n            filter((touchEvent) => touchEvent.touches.length === touchNumber)\r\n        ),\r\n        fromEvent<MouseEvent>(element, 'mousedown', activeEventListenerOptions as AddEventListenerOptions).pipe(\r\n            filter((mouseEvent: MouseEvent) => {\r\n                /**\r\n                 * 0 : Left mouse button\r\n                 * 1 : Wheel button or middle button (if present)\r\n                 * 2 : Right mouse button\r\n                 */\r\n                return mouseEvent.button === 0; // Mouse down to be only fired if is left click\r\n            })\r\n        )\r\n    );\r\n}\r\n\r\n/**\r\n * Emits when a 'mousemove' or a 'touchmove' event gets fired.\r\n * @param element, html element where to  listen the events.\r\n * @param touchNumber number of the touch to track the event, default to the first one.\r\n */\r\nexport function ktdMouseOrTouchMove(element, touchNumber = 1): Observable<MouseEvent | TouchEvent> {\r\n    return iif(\r\n        () => ktdIsMobileOrTablet(),\r\n        fromEvent<TouchEvent>(element, 'touchmove', activeEventListenerOptions as AddEventListenerOptions).pipe(\r\n            filter((touchEvent) => touchEvent.touches.length === touchNumber),\r\n        ),\r\n        fromEvent<MouseEvent>(element, 'mousemove', activeEventListenerOptions as AddEventListenerOptions)\r\n    );\r\n}\r\n\r\nexport function ktdTouchEnd(element, touchNumber = 1): Observable<TouchEvent> {\r\n    return merge(\r\n        fromEvent<TouchEvent>(element, 'touchend').pipe(\r\n            filter((touchEvent) => touchEvent.touches.length === touchNumber - 1)\r\n        ),\r\n        fromEvent<TouchEvent>(element, 'touchcancel').pipe(\r\n            filter((touchEvent) => touchEvent.touches.length === touchNumber - 1)\r\n        )\r\n    );\r\n}\r\n\r\n/**\r\n * Emits when a there is a 'mouseup' or the touch ends.\r\n * @param element, html element where to  listen the events.\r\n * @param touchNumber number of the touch to track the event, default to the first one.\r\n */\r\nexport function ktdMouseOrTouchEnd(element, touchNumber = 1): Observable<MouseEvent | TouchEvent> {\r\n    return iif(\r\n        () => ktdIsMobileOrTablet(),\r\n        ktdTouchEnd(element, touchNumber),\r\n        fromEvent<MouseEvent>(element, 'mouseup'),\r\n    );\r\n}\r\n","import { compact, CompactType, getFirstCollision, Layout, LayoutItem, moveElement } from './react-grid-layout.utils';\r\nimport { KtdDraggingData, KtdGridCfg, KtdGridCompactType, KtdGridItemRect, KtdGridLayout, KtdGridLayoutItem } from '../grid.definitions';\r\nimport { ktdPointerClientX, ktdPointerClientY } from './pointer.utils';\r\nimport { KtdDictionary } from '../../types';\r\nimport { KtdGridItemComponent } from '../grid-item/grid-item.component';\r\n\r\n/** Tracks items by id. This function is mean to be used in conjunction with the ngFor that renders the 'ktd-grid-items' */\r\nexport function ktdTrackById(index: number, item: {id: string}) {\r\n    return item.id;\r\n}\r\n\r\n/**\r\n * Call react-grid-layout utils 'compact()' function and return the compacted layout.\r\n * @param layout to be compacted.\r\n * @param compactType, type of compaction.\r\n * @param cols, number of columns of the grid.\r\n */\r\nexport function ktdGridCompact(layout: KtdGridLayout, compactType: KtdGridCompactType, cols: number): KtdGridLayout {\r\n    return compact(layout, compactType, cols)\r\n        // Prune react-grid-layout compact extra properties.\r\n        .map(item => ({ id: item.id, x: item.x, y: item.y, w: item.w, h: item.h, minW: item.minW, minH: item.minH, maxW: item.maxW, maxH: item.maxH }));\r\n}\r\n\r\nfunction screenXPosToGridValue(screenXPos: number, cols: number, width: number): number {\r\n    return Math.round((screenXPos * cols) / width);\r\n}\r\n\r\nfunction screenYPosToGridValue(screenYPos: number, rowHeight: number, height: number): number {\r\n    return Math.round(screenYPos / rowHeight);\r\n}\r\n\r\n/** Returns a Dictionary where the key is the id and the value is the change applied to that item. If no changes Dictionary is empty. */\r\nexport function ktdGetGridLayoutDiff(gridLayoutA: KtdGridLayoutItem[], gridLayoutB: KtdGridLayoutItem[]): KtdDictionary<{ change: 'move' | 'resize' | 'moveresize' }> {\r\n    const diff: KtdDictionary<{ change: 'move' | 'resize' | 'moveresize' }> = {};\r\n\r\n    gridLayoutA.forEach(itemA => {\r\n        const itemB = gridLayoutB.find(_itemB => _itemB.id === itemA.id);\r\n        if (itemB != null) {\r\n            const posChanged = itemA.x !== itemB.x || itemA.y !== itemB.y;\r\n            const sizeChanged = itemA.w !== itemB.w || itemA.h !== itemB.h;\r\n            const change: 'move' | 'resize' | 'moveresize' | null = posChanged && sizeChanged ? 'moveresize' : posChanged ? 'move' : sizeChanged ? 'resize' : null;\r\n            if (change) {\r\n                diff[itemB.id] = {change};\r\n            }\r\n        }\r\n    });\r\n    return diff;\r\n}\r\n\r\n/**\r\n * Given the grid config & layout data and the current drag position & information, returns the corresponding layout and drag item position\r\n * @param gridItem grid item that is been dragged\r\n * @param config current grid configuration\r\n * @param compactionType type of compaction that will be performed\r\n * @param draggingData contains all the information about the drag\r\n */\r\nexport function ktdGridItemDragging(gridItem: KtdGridItemComponent, config: KtdGridCfg, compactionType: CompactType, draggingData: KtdDraggingData): { layout: KtdGridLayoutItem[]; draggedItemPos: KtdGridItemRect } {\r\n    const {pointerDownEvent, pointerDragEvent, gridElemClientRect, dragElemClientRect, scrollDifference} = draggingData;\r\n\r\n    const gridItemId = gridItem.id;\r\n\r\n    const draggingElemPrevItem = config.layout.find(item => item.id === gridItemId)!;\r\n\r\n    const clientStartX = ktdPointerClientX(pointerDownEvent);\r\n    const clientStartY = ktdPointerClientY(pointerDownEvent);\r\n    const clientX = ktdPointerClientX(pointerDragEvent);\r\n    const clientY = ktdPointerClientY(pointerDragEvent);\r\n\r\n    const offsetX = clientStartX - dragElemClientRect.left;\r\n    const offsetY = clientStartY - dragElemClientRect.top;\r\n\r\n    // Grid element positions taking into account the possible scroll total difference from the beginning.\r\n    const gridElementLeftPosition = gridElemClientRect.left + scrollDifference.left;\r\n    const gridElementTopPosition = gridElemClientRect.top + scrollDifference.top;\r\n\r\n    // Calculate position relative to the grid element.\r\n    const gridRelXPos = clientX - gridElementLeftPosition - offsetX;\r\n    const gridRelYPos = clientY - gridElementTopPosition - offsetY;\r\n\r\n    // Get layout item position\r\n    const layoutItem: KtdGridLayoutItem = {\r\n        ...draggingElemPrevItem,\r\n        x: screenXPosToGridValue(gridRelXPos, config.cols, gridElemClientRect.width),\r\n        y: screenYPosToGridValue(gridRelYPos, config.rowHeight, gridElemClientRect.height)\r\n    };\r\n\r\n    // Correct the values if they overflow, since 'moveElement' function doesn't do it\r\n    layoutItem.x = Math.max(0, layoutItem.x);\r\n    layoutItem.y = Math.max(0, layoutItem.y);\r\n    if (layoutItem.x + layoutItem.w > config.cols) {\r\n        layoutItem.x = Math.max(0, config.cols - layoutItem.w);\r\n    }\r\n\r\n    // Parse to LayoutItem array data in order to use 'react.grid-layout' utils\r\n    const layoutItems: LayoutItem[] = config.layout;\r\n    const draggedLayoutItem: LayoutItem = layoutItems.find(item => item.id === gridItemId)!;\r\n\r\n    let newLayoutItems: LayoutItem[] = moveElement(\r\n        layoutItems,\r\n        draggedLayoutItem,\r\n        layoutItem.x,\r\n        layoutItem.y,\r\n        true,\r\n        config.preventCollision,\r\n        compactionType,\r\n        config.cols\r\n    );\r\n\r\n    newLayoutItems = compact(newLayoutItems, compactionType, config.cols);\r\n\r\n    return {\r\n        layout: newLayoutItems,\r\n        draggedItemPos: {\r\n            top: gridRelYPos,\r\n            left: gridRelXPos,\r\n            width: dragElemClientRect.width,\r\n            height: dragElemClientRect.height,\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n * Given the grid config & layout data and the current drag position & information, returns the corresponding layout and drag item position\r\n * @param gridItem grid item that is been dragged\r\n * @param config current grid configuration\r\n * @param compactionType type of compaction that will be performed\r\n * @param draggingData contains all the information about the drag\r\n */\r\nexport function ktdGridItemResizing(gridItem: KtdGridItemComponent, config: KtdGridCfg, compactionType: CompactType, draggingData: KtdDraggingData): { layout: KtdGridLayoutItem[]; draggedItemPos: KtdGridItemRect } {\r\n    const {pointerDownEvent, pointerDragEvent, gridElemClientRect, dragElemClientRect, scrollDifference} = draggingData;\r\n    const gridItemId = gridItem.id;\r\n\r\n    const clientStartX = ktdPointerClientX(pointerDownEvent);\r\n    const clientStartY = ktdPointerClientY(pointerDownEvent);\r\n    const clientX = ktdPointerClientX(pointerDragEvent);\r\n    const clientY = ktdPointerClientY(pointerDragEvent);\r\n\r\n    // Get the difference between the mouseDown and the position 'right' of the resize element.\r\n    const resizeElemOffsetX = dragElemClientRect.width - (clientStartX - dragElemClientRect.left);\r\n    const resizeElemOffsetY = dragElemClientRect.height - (clientStartY - dragElemClientRect.top);\r\n\r\n    const draggingElemPrevItem = config.layout.find(item => item.id === gridItemId)!;\r\n    const width = clientX + resizeElemOffsetX - (dragElemClientRect.left + scrollDifference.left);\r\n    const height = clientY + resizeElemOffsetY - (dragElemClientRect.top + scrollDifference.top);\r\n\r\n\r\n    // Get layout item grid position\r\n    const layoutItem: KtdGridLayoutItem = {\r\n        ...draggingElemPrevItem,\r\n        w: screenXPosToGridValue(width, config.cols, gridElemClientRect.width),\r\n        h: screenYPosToGridValue(height, config.rowHeight, gridElemClientRect.height)\r\n    };\r\n\r\n    layoutItem.w = limitNumberWithinRange(layoutItem.w, gridItem.minW ?? layoutItem.minW, gridItem.maxW ?? layoutItem.maxW);\r\n    layoutItem.h = limitNumberWithinRange(layoutItem.h, gridItem.minH ?? layoutItem.minH, gridItem.maxH ?? layoutItem.maxH);\r\n\r\n    if (layoutItem.x + layoutItem.w > config.cols) {\r\n        layoutItem.w = Math.max(1, config.cols - layoutItem.x);\r\n    }\r\n\r\n    if (config.preventCollision) {\r\n        const maxW = layoutItem.w;\r\n        const maxH = layoutItem.h;\r\n\r\n        let colliding = hasCollision(config.layout, layoutItem);\r\n        let shrunkDimension: 'w' | 'h' | undefined;\r\n\r\n        while (colliding) {\r\n            shrunkDimension = getDimensionToShrink(layoutItem, shrunkDimension);\r\n            layoutItem[shrunkDimension]--;\r\n            colliding = hasCollision(config.layout, layoutItem);\r\n        }\r\n\r\n        if (shrunkDimension === 'w') {\r\n            layoutItem.h = maxH;\r\n\r\n            colliding = hasCollision(config.layout, layoutItem);\r\n            while (colliding) {\r\n                layoutItem.h--;\r\n                colliding = hasCollision(config.layout, layoutItem);\r\n            }\r\n        }\r\n        if (shrunkDimension === 'h') {\r\n            layoutItem.w = maxW;\r\n\r\n            colliding = hasCollision(config.layout, layoutItem);\r\n            while (colliding) {\r\n                layoutItem.w--;\r\n                colliding = hasCollision(config.layout, layoutItem);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    const newLayoutItems: LayoutItem[] = config.layout.map((item) => {\r\n        return item.id === gridItemId ? layoutItem : item;\r\n    });\r\n\r\n    return {\r\n        layout: compact(newLayoutItems, compactionType, config.cols),\r\n        draggedItemPos: {\r\n            top: dragElemClientRect.top - gridElemClientRect.top,\r\n            left: dragElemClientRect.left - gridElemClientRect.left,\r\n            width,\r\n            height,\r\n        }\r\n    };\r\n}\r\n\r\nfunction hasCollision(layout: Layout, layoutItem: LayoutItem): boolean {\r\n    return !!getFirstCollision(layout, layoutItem);\r\n}\r\n\r\nfunction getDimensionToShrink(layoutItem, lastShrunk): 'w' | 'h' {\r\n    if (layoutItem.h <= 1) {\r\n        return 'w';\r\n    }\r\n    if (layoutItem.w <= 1) {\r\n        return 'h';\r\n    }\r\n\r\n    return lastShrunk === 'w' ? 'h' : 'w';\r\n}\r\n\r\n/**\r\n * Given the current number and min/max values, returns the number within the range\r\n * @param number can be any numeric value\r\n * @param min minimum value of range\r\n * @param max maximum value of range\r\n */\r\nfunction limitNumberWithinRange(num: number, min: number = 1, max: number = Infinity) {\r\n    return Math.min(Math.max(num, min < 1 ? 1 : min), max);\r\n}\r\n","import { Directive, ElementRef, InjectionToken } from '@angular/core';\r\n\r\n/**\r\n * Injection token that can be used to reference instances of `KtdGridDragHandle`. It serves as\r\n * alternative token to the actual `KtdGridDragHandle` class which could cause unnecessary\r\n * retention of the class and its directive metadata.\r\n */\r\nexport const KTD_GRID_DRAG_HANDLE = new InjectionToken<KtdGridDragHandle>('KtdGridDragHandle');\r\n\r\n/** Handle that can be used to drag a KtdGridItem instance. */\r\n@Directive({\r\n    selector: '[ktdGridDragHandle]',\r\n    host: {\r\n        class: 'ktd-grid-drag-handle'\r\n    },\r\n    providers: [{provide: KTD_GRID_DRAG_HANDLE, useExisting: KtdGridDragHandle}],\r\n})\r\n// tslint:disable-next-line:directive-class-suffix\r\nexport class KtdGridDragHandle {\r\n    constructor(\r\n        public element: ElementRef<HTMLElement>) {\r\n    }\r\n}\r\n","import { Directive, ElementRef, InjectionToken, } from '@angular/core';\r\n\r\n\r\n/**\r\n * Injection token that can be used to reference instances of `KtdGridResizeHandle`. It serves as\r\n * alternative token to the actual `KtdGridResizeHandle` class which could cause unnecessary\r\n * retention of the class and its directive metadata.\r\n */\r\nexport const KTD_GRID_RESIZE_HANDLE = new InjectionToken<KtdGridResizeHandle>('KtdGridResizeHandle');\r\n\r\n/** Handle that can be used to drag a KtdGridItem instance. */\r\n@Directive({\r\n    selector: '[ktdGridResizeHandle]',\r\n    host: {\r\n        class: 'ktd-grid-resize-handle'\r\n    },\r\n    providers: [{provide: KTD_GRID_RESIZE_HANDLE, useExisting: KtdGridResizeHandle}],\r\n})\r\nexport class KtdGridResizeHandle {\r\n\r\n    constructor(\r\n        public element: ElementRef<HTMLElement>) {\r\n    }\r\n}\r\n","import { InjectionToken } from '@angular/core';\r\nimport { CompactType } from './utils/react-grid-layout.utils';\r\n\r\nexport interface KtdGridLayoutItem {\r\n    id: string;\r\n    x: number;\r\n    y: number;\r\n    w: number;\r\n    h: number;\r\n    minW?: number;\r\n    minH?: number;\r\n    maxW?: number;\r\n    maxH?: number;\r\n}\r\n\r\nexport type KtdGridCompactType = CompactType;\r\n\r\nexport interface KtdGridCfg {\r\n    cols: number;\r\n    rowHeight: number; // row height in pixels\r\n    layout: KtdGridLayoutItem[];\r\n    preventCollision: boolean;\r\n}\r\n\r\nexport type KtdGridLayout = KtdGridLayoutItem[];\r\n\r\n// TODO: Remove this interface. If can't remove, move and rename this interface in the core module or similar.\r\nexport interface KtdGridItemRect {\r\n    top: number;\r\n    left: number;\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport interface KtdGridItemRenderData<T = number | string> {\r\n    id: string;\r\n    top: T;\r\n    left: T;\r\n    width: T;\r\n    height: T;\r\n}\r\n\r\n/**\r\n * We inject a token because of the 'circular dependency issue warning'. In case we don't had this issue with the circular dependency, we could just\r\n * import KtdGridComponent on KtdGridItem and execute the needed function to get the rendering data.\r\n */\r\nexport type KtdGridItemRenderDataTokenType = (id: string) => KtdGridItemRenderData<string>;\r\nexport const GRID_ITEM_GET_RENDER_DATA_TOKEN: InjectionToken<KtdGridItemRenderDataTokenType> = new InjectionToken('GRID_ITEM_GET_RENDER_DATA_TOKEN');\r\n\r\nexport interface KtdDraggingData {\r\n    pointerDownEvent: MouseEvent | TouchEvent;\r\n    pointerDragEvent: MouseEvent | TouchEvent;\r\n    gridElemClientRect: ClientRect;\r\n    dragElemClientRect: ClientRect;\r\n    scrollDifference: { top: number, left: number };\r\n}\r\n","import { NgZone } from '@angular/core';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\n/** Runs source observable outside the zone */\r\nexport function ktdOutsideZone<T>(zone: NgZone) {\r\n    return (source: Observable<T>) => {\r\n        return new Observable<T>(observer => {\r\n            return zone.runOutsideAngular<Subscription>(() => source.subscribe(observer));\r\n        });\r\n    };\r\n}\r\n\r\n\r\n/** Rxjs operator that makes source observable to no emit any data */\r\nexport function ktdNoEmit() {\r\n    return (source$: Observable<any>): Observable<any> => {\r\n        return source$.pipe(filter(() => false));\r\n    };\r\n}\r\n","// tslint:disable\r\n/**\r\n * Type describing the allowed values for a boolean input.\r\n * @docs-private\r\n */\r\nexport type BooleanInput = string | boolean | null | undefined;\r\n\r\n/** Coerces a data-bound value (typically a string) to a boolean. */\r\nexport function coerceBooleanProperty(value: any): boolean {\r\n  return value != null && `${value}` !== 'false';\r\n}\r\n","// tslint:disable\r\nexport type NumberInput = string | number | null | undefined;\r\n\r\n/** Coerces a data-bound value (typically a string) to a number. */\r\nexport function coerceNumberProperty(value: any): number;\r\nexport function coerceNumberProperty<D>(value: any, fallback: D): number | D;\r\nexport function coerceNumberProperty(value: any, fallbackValue = 0) {\r\n    return _isNumberValue(value) ? Number(value) : fallbackValue;\r\n}\r\n\r\n/**\r\n * Whether the provided value is considered a number.\r\n * @docs-private\r\n */\r\nexport function _isNumberValue(value: any): boolean {\r\n    // parseFloat(value) handles most of the cases we're interested in (it treats null, empty string,\r\n    // and other non-number values as NaN, where Number just uses 0) but it considers the string\r\n    // '123hello' to be a valid number. Therefore we also check if Number(value) is NaN.\r\n    return !isNaN(parseFloat(value as any)) && !isNaN(Number(value));\r\n}\r\n","import { Injectable, NgZone, OnDestroy } from '@angular/core';\r\nimport { ktdNormalizePassiveListenerOptions } from './utils/passive-listeners';\r\nimport { fromEvent, iif, Observable, Subject, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { ktdIsMobileOrTablet } from './utils/pointer.utils';\r\n\r\n/** Event options that can be used to bind an active, capturing event. */\r\nconst activeCapturingEventOptions = ktdNormalizePassiveListenerOptions({\r\n    passive: false,\r\n    capture: true\r\n});\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport class KtdGridService implements OnDestroy {\r\n\r\n    touchMove$: Observable<TouchEvent>;\r\n    private touchMoveSubject: Subject<TouchEvent> = new Subject<TouchEvent>();\r\n    private touchMoveSubscription: Subscription;\r\n\r\n    constructor(private ngZone: NgZone) {\r\n        this.touchMove$ = this.touchMoveSubject.asObservable();\r\n        this.registerTouchMoveSubscription();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.touchMoveSubscription.unsubscribe();\r\n    }\r\n\r\n    mouseOrTouchMove$(element): Observable<MouseEvent | TouchEvent> {\r\n        return iif(\r\n            () => ktdIsMobileOrTablet(),\r\n            this.touchMove$,\r\n            fromEvent<MouseEvent>(element, 'mousemove', activeCapturingEventOptions as AddEventListenerOptions) // TODO: Fix rxjs typings, boolean should be a good param too.\r\n        );\r\n    }\r\n\r\n    private registerTouchMoveSubscription() {\r\n        // The `touchmove` event gets bound once, ahead of time, because WebKit\r\n        // won't preventDefault on a dynamically-added `touchmove` listener.\r\n        // See https://bugs.webkit.org/show_bug.cgi?id=184250.\r\n        this.touchMoveSubscription = this.ngZone.runOutsideAngular(() =>\r\n            // The event handler has to be explicitly active,\r\n            // because newer browsers make it passive by default.\r\n            fromEvent(document, 'touchmove', activeCapturingEventOptions as AddEventListenerOptions) // TODO: Fix rxjs typings, boolean should be a good param too.\r\n                .pipe(filter((touchEvent: TouchEvent) => touchEvent.touches.length === 1))\r\n                .subscribe((touchEvent: TouchEvent) => this.touchMoveSubject.next(touchEvent))\r\n        );\r\n    }\r\n}\r\n","import {\r\n    AfterContentInit, ChangeDetectionStrategy, Component, ContentChildren, ElementRef, Inject, Input, NgZone, OnDestroy, OnInit, QueryList, Renderer2,\r\n    ViewChild\r\n} from '@angular/core';\r\nimport { BehaviorSubject, iif, merge, NEVER, Observable, Subject, Subscription } from 'rxjs';\r\nimport { exhaustMap, filter, map, startWith, switchMap, take, takeUntil } from 'rxjs/operators';\r\nimport { ktdMouseOrTouchDown, ktdMouseOrTouchEnd, ktdPointerClient } from '../utils/pointer.utils';\r\nimport { GRID_ITEM_GET_RENDER_DATA_TOKEN, KtdGridItemRenderDataTokenType } from '../grid.definitions';\r\nimport { KTD_GRID_DRAG_HANDLE, KtdGridDragHandle } from '../directives/drag-handle';\r\nimport { KTD_GRID_RESIZE_HANDLE, KtdGridResizeHandle } from '../directives/resize-handle';\r\nimport { KtdGridService } from '../grid.service';\r\nimport { ktdOutsideZone } from '../utils/operators';\r\nimport { BooleanInput, coerceBooleanProperty } from '../coercion/boolean-property';\r\nimport { coerceNumberProperty, NumberInput } from '../coercion/number-property';\r\n\r\n@Component({\r\n    selector: 'ktd-grid-item',\r\n    templateUrl: './grid-item.component.html',\r\n    styleUrls: ['./grid-item.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class KtdGridItemComponent implements OnInit, OnDestroy, AfterContentInit {\r\n    /** Elements that can be used to drag the grid item. */\r\n    @ContentChildren(KTD_GRID_DRAG_HANDLE, {descendants: true}) _dragHandles: QueryList<KtdGridDragHandle>;\r\n    @ContentChildren(KTD_GRID_RESIZE_HANDLE, {descendants: true}) _resizeHandles: QueryList<KtdGridResizeHandle>;\r\n    @ViewChild('resizeElem', {static: true, read: ElementRef}) resizeElem: ElementRef;\r\n\r\n    /** Min and max size input properties. Any of these would 'override' the min/max values specified in the layout. */\r\n    @Input() minW?: number;\r\n    @Input() minH?: number;\r\n    @Input() maxW?: number;\r\n    @Input() maxH?: number;\r\n\r\n    /** CSS transition style. Note that for more performance is preferable only make transition on transform property. */\r\n    @Input() transition: string = 'transform 500ms ease, width 500ms ease, height 500ms ease';\r\n\r\n    dragStart$: Observable<MouseEvent | TouchEvent>;\r\n    resizeStart$: Observable<MouseEvent | TouchEvent>;\r\n\r\n    /** Id of the grid item. This property is strictly compulsory. */\r\n    @Input()\r\n    get id(): string {\r\n        return this._id;\r\n    }\r\n\r\n    set id(val: string) {\r\n        this._id = val;\r\n    }\r\n\r\n    private _id: string;\r\n\r\n    /** Minimum amount of pixels that the user should move before it starts the drag sequence. */\r\n    @Input()\r\n    get dragStartThreshold(): number { return this._dragStartThreshold; }\r\n\r\n    set dragStartThreshold(val: number) {\r\n        this._dragStartThreshold = coerceNumberProperty(val);\r\n    }\r\n\r\n    private _dragStartThreshold: number = 0;\r\n\r\n\r\n    /** Whether the item is draggable or not. Defaults to true. */\r\n    @Input()\r\n    get draggable(): boolean {\r\n        return this._draggable;\r\n    }\r\n\r\n    set draggable(val: boolean) {\r\n        this._draggable = coerceBooleanProperty(val);\r\n        this._draggable$.next(this._draggable);\r\n    }\r\n\r\n    private _draggable: boolean = true;\r\n    private _draggable$: BehaviorSubject<boolean> = new BehaviorSubject<boolean>(this._draggable);\r\n\r\n    /** Whether the item is resizable or not. Defaults to true. */\r\n    @Input()\r\n    get resizable(): boolean {\r\n        return this._resizable;\r\n    }\r\n\r\n    set resizable(val: boolean) {\r\n        this._resizable = coerceBooleanProperty(val);\r\n        this._resizable$.next(this._resizable);\r\n    }\r\n\r\n    private _resizable: boolean = true;\r\n    private _resizable$: BehaviorSubject<boolean> = new BehaviorSubject<boolean>(this._resizable);\r\n\r\n    private dragStartSubject: Subject<MouseEvent | TouchEvent> = new Subject<MouseEvent | TouchEvent>();\r\n    private resizeStartSubject: Subject<MouseEvent | TouchEvent> = new Subject<MouseEvent | TouchEvent>();\r\n\r\n    private subscriptions: Subscription[] = [];\r\n\r\n    constructor(public elementRef: ElementRef,\r\n                private gridService: KtdGridService,\r\n                private renderer: Renderer2,\r\n                private ngZone: NgZone,\r\n                @Inject(GRID_ITEM_GET_RENDER_DATA_TOKEN) private getItemRenderData: KtdGridItemRenderDataTokenType) {\r\n        this.dragStart$ = this.dragStartSubject.asObservable();\r\n        this.resizeStart$ = this.resizeStartSubject.asObservable();\r\n    }\r\n\r\n    ngOnInit() {\r\n        const gridItemRenderData = this.getItemRenderData(this.id)!;\r\n        this.setStyles(gridItemRenderData);\r\n    }\r\n\r\n    ngAfterContentInit() {\r\n        this.subscriptions.push(\r\n            this._dragStart$().subscribe(this.dragStartSubject),\r\n            this._resizeStart$().subscribe(this.resizeStartSubject),\r\n        );\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.subscriptions.forEach(sub => sub.unsubscribe());\r\n    }\r\n\r\n    setStyles({top, left, width, height}: { top: string, left: string, width?: string, height?: string }) {\r\n        // transform is 6x times faster than top/left\r\n        this.renderer.setStyle(this.elementRef.nativeElement, 'transform', `translateX(${left}) translateY(${top})`);\r\n        this.renderer.setStyle(this.elementRef.nativeElement, 'display', `block`);\r\n        this.renderer.setStyle(this.elementRef.nativeElement, 'transition', this.transition);\r\n        if (width != null) { this.renderer.setStyle(this.elementRef.nativeElement, 'width', width); }\r\n        if (height != null) {this.renderer.setStyle(this.elementRef.nativeElement, 'height', height); }\r\n    }\r\n\r\n    private _dragStart$(): Observable<MouseEvent | TouchEvent> {\r\n        return this._draggable$.pipe(\r\n            switchMap((draggable) => {\r\n                if (!draggable) {\r\n                    return NEVER;\r\n                } else {\r\n                    return this._dragHandles.changes.pipe(\r\n                        startWith(this._dragHandles),\r\n                        switchMap((dragHandles: QueryList<KtdGridDragHandle>) => {\r\n                            return iif(\r\n                                () => dragHandles.length > 0,\r\n                                merge(...dragHandles.toArray().map(dragHandle => ktdMouseOrTouchDown(dragHandle.element.nativeElement, 1))),\r\n                                ktdMouseOrTouchDown(this.elementRef.nativeElement, 1)\r\n                            ).pipe(\r\n                                exhaustMap((startEvent) => {\r\n                                    // If the event started from an element with the native HTML drag&drop, it'll interfere\r\n                                    // with our own dragging (e.g. `img` tags do it by default). Prevent the default action\r\n                                    // to stop it from happening. Note that preventing on `dragstart` also seems to work, but\r\n                                    // it's flaky and it fails if the user drags it away quickly. Also note that we only want\r\n                                    // to do this for `mousedown` since doing the same for `touchstart` will stop any `click`\r\n                                    // events from firing on touch devices.\r\n                                    if (startEvent.target && (startEvent.target as HTMLElement).draggable && startEvent.type === 'mousedown') {\r\n                                        startEvent.preventDefault();\r\n                                    }\r\n\r\n                                    const startPointer = ktdPointerClient(startEvent);\r\n                                    return this.gridService.mouseOrTouchMove$(document).pipe(\r\n                                        takeUntil(ktdMouseOrTouchEnd(document, 1)),\r\n                                        ktdOutsideZone(this.ngZone),\r\n                                        filter((moveEvent) => {\r\n                                            moveEvent.preventDefault();\r\n                                            const movePointer = ktdPointerClient(moveEvent);\r\n                                            const distanceX = Math.abs(startPointer.clientX - movePointer.clientX);\r\n                                            const distanceY = Math.abs(startPointer.clientY - movePointer.clientY);\r\n                                            // When this conditions returns true mean that we are over threshold.\r\n                                            return distanceX + distanceY >= this.dragStartThreshold;\r\n                                        }),\r\n                                        take(1),\r\n                                        // Return the original start event\r\n                                        map(() => startEvent)\r\n                                    );\r\n                                })\r\n                            );\r\n                        })\r\n                    );\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n    private _resizeStart$(): Observable<MouseEvent | TouchEvent> {\r\n        return this._resizable$.pipe(\r\n            switchMap((resizable) => {\r\n                if (!resizable) {\r\n                    // Side effect to hide the resizeElem if resize is disabled.\r\n                    this.renderer.setStyle(this.resizeElem.nativeElement, 'display', 'none');\r\n                    return NEVER;\r\n                } else {\r\n                    return this._resizeHandles.changes.pipe(\r\n                        startWith(this._resizeHandles),\r\n                        switchMap((resizeHandles: QueryList<KtdGridResizeHandle>) => {\r\n                            if (resizeHandles.length > 0) {\r\n                                // Side effect to hide the resizeElem if there are resize handles.\r\n                                this.renderer.setStyle(this.resizeElem.nativeElement, 'display', 'none');\r\n                                return merge(...resizeHandles.toArray().map(resizeHandle => ktdMouseOrTouchDown(resizeHandle.element.nativeElement, 1)));\r\n                            } else {\r\n                                this.renderer.setStyle(this.resizeElem.nativeElement, 'display', 'block');\r\n                                return ktdMouseOrTouchDown(this.resizeElem.nativeElement, 1);\r\n                            }\r\n                        })\r\n                    );\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_minW: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_minH: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_maxW: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_maxH: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_draggable: BooleanInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_resizable: BooleanInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_dragStartThreshold: NumberInput;\r\n\r\n}\r\n","<ng-content></ng-content>\r\n<div #resizeElem class=\"grid-item-resize-icon\"></div>\r\n","\r\n// tslint:disable\r\n\r\n/**\r\n * Client rect utilities.\r\n * This file is taken from Angular Material repository. This is the reason why the tslint is disabled on this case.\r\n * Don't enable it until some custom change is done on this file.\r\n */\r\n\r\n\r\n/** Gets a mutable version of an element's bounding `ClientRect`. */\r\nexport function getMutableClientRect(element: Element): ClientRect {\r\n  const clientRect = element.getBoundingClientRect();\r\n\r\n  // We need to clone the `clientRect` here, because all the values on it are readonly\r\n  // and we need to be able to update them. Also we can't use a spread here, because\r\n  // the values on a `ClientRect` aren't own properties. See:\r\n  // https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect#Notes\r\n  return {\r\n    top: clientRect.top,\r\n    right: clientRect.right,\r\n    bottom: clientRect.bottom,\r\n    left: clientRect.left,\r\n    width: clientRect.width,\r\n    height: clientRect.height\r\n  };\r\n}\r\n\r\n/**\r\n * Checks whether some coordinates are within a `ClientRect`.\r\n * @param clientRect ClientRect that is being checked.\r\n * @param x Coordinates along the X axis.\r\n * @param y Coordinates along the Y axis.\r\n */\r\nexport function isInsideClientRect(clientRect: ClientRect, x: number, y: number) {\r\n  const {top, bottom, left, right} = clientRect;\r\n  return y >= top && y <= bottom && x >= left && x <= right;\r\n}\r\n\r\n/**\r\n * Updates the top/left positions of a `ClientRect`, as well as their bottom/right counterparts.\r\n * @param clientRect `ClientRect` that should be updated.\r\n * @param top Amount to add to the `top` position.\r\n * @param left Amount to add to the `left` position.\r\n */\r\nexport function adjustClientRect(clientRect: ClientRect, top: number, left: number) {\r\n  clientRect.top += top;\r\n  clientRect.bottom = clientRect.top + clientRect.height;\r\n\r\n  clientRect.left += left;\r\n  clientRect.right = clientRect.left + clientRect.width;\r\n}\r\n\r\n/**\r\n * Checks whether the pointer coordinates are close to a ClientRect.\r\n * @param rect ClientRect to check against.\r\n * @param threshold Threshold around the ClientRect.\r\n * @param pointerX Coordinates along the X axis.\r\n * @param pointerY Coordinates along the Y axis.\r\n */\r\nexport function isPointerNearClientRect(rect: ClientRect,\r\n                                        threshold: number,\r\n                                        pointerX: number,\r\n                                        pointerY: number): boolean {\r\n  const {top, right, bottom, left, width, height} = rect;\r\n  const xThreshold = width * threshold;\r\n  const yThreshold = height * threshold;\r\n\r\n  return pointerY > top - yThreshold && pointerY < bottom + yThreshold &&\r\n         pointerX > left - xThreshold && pointerX < right + xThreshold;\r\n}\r\n","import { animationFrameScheduler, fromEvent, interval, NEVER, Observable } from 'rxjs';\r\nimport { distinctUntilChanged, map, switchMap, tap } from 'rxjs/operators';\r\nimport { ktdNormalizePassiveListenerOptions } from './passive-listeners';\r\nimport { getMutableClientRect } from './client-rect';\r\nimport { ktdNoEmit } from './operators';\r\n\r\n/**\r\n * Proximity, as a ratio to width/height at which to start auto-scrolling.\r\n * The value comes from trying it out manually until it feels right.\r\n */\r\nconst SCROLL_PROXIMITY_THRESHOLD = 0.05;\r\n\r\n/** Vertical direction in which we can auto-scroll. */\r\nconst enum AutoScrollVerticalDirection {NONE, UP, DOWN}\r\n\r\n/** Horizontal direction in which we can auto-scroll. */\r\nconst enum AutoScrollHorizontalDirection {NONE, LEFT, RIGHT}\r\n\r\nexport interface KtdScrollPosition {\r\n    top: number;\r\n    left: number;\r\n}\r\n\r\n\r\n/**\r\n * Increments the vertical scroll position of a node.\r\n * @param node Node whose scroll position should change.\r\n * @param amount Amount of pixels that the `node` should be scrolled.\r\n */\r\nfunction incrementVerticalScroll(node: HTMLElement | Window, amount: number) {\r\n    if (node === window) {\r\n        (node as Window).scrollBy(0, amount);\r\n    } else {\r\n        // Ideally we could use `Element.scrollBy` here as well, but IE and Edge don't support it.\r\n        (node as HTMLElement).scrollTop += amount;\r\n    }\r\n}\r\n\r\n/**\r\n * Increments the horizontal scroll position of a node.\r\n * @param node Node whose scroll position should change.\r\n * @param amount Amount of pixels that the `node` should be scrolled.\r\n */\r\nfunction incrementHorizontalScroll(node: HTMLElement | Window, amount: number) {\r\n    if (node === window) {\r\n        (node as Window).scrollBy(amount, 0);\r\n    } else {\r\n        // Ideally we could use `Element.scrollBy` here as well, but IE and Edge don't support it.\r\n        (node as HTMLElement).scrollLeft += amount;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Gets whether the vertical auto-scroll direction of a node.\r\n * @param clientRect Dimensions of the node.\r\n * @param pointerY Position of the user's pointer along the y axis.\r\n */\r\nfunction getVerticalScrollDirection(clientRect: ClientRect, pointerY: number) {\r\n    const {top, bottom, height} = clientRect;\r\n    const yThreshold = height * SCROLL_PROXIMITY_THRESHOLD;\r\n\r\n    if (pointerY >= top - yThreshold && pointerY <= top + yThreshold) {\r\n        return AutoScrollVerticalDirection.UP;\r\n    } else if (pointerY >= bottom - yThreshold && pointerY <= bottom + yThreshold) {\r\n        return AutoScrollVerticalDirection.DOWN;\r\n    }\r\n\r\n    return AutoScrollVerticalDirection.NONE;\r\n}\r\n\r\n/**\r\n * Gets whether the horizontal auto-scroll direction of a node.\r\n * @param clientRect Dimensions of the node.\r\n * @param pointerX Position of the user's pointer along the x axis.\r\n */\r\nfunction getHorizontalScrollDirection(clientRect: ClientRect, pointerX: number) {\r\n    const {left, right, width} = clientRect;\r\n    const xThreshold = width * SCROLL_PROXIMITY_THRESHOLD;\r\n\r\n    if (pointerX >= left - xThreshold && pointerX <= left + xThreshold) {\r\n        return AutoScrollHorizontalDirection.LEFT;\r\n    } else if (pointerX >= right - xThreshold && pointerX <= right + xThreshold) {\r\n        return AutoScrollHorizontalDirection.RIGHT;\r\n    }\r\n\r\n    return AutoScrollHorizontalDirection.NONE;\r\n}\r\n\r\n/**\r\n * Returns an observable that schedules a loop and apply scroll on the scrollNode into the specified direction/s.\r\n * This observable doesn't emit, it just performs the 'scroll' side effect.\r\n * @param scrollNode, node where the scroll would be applied.\r\n * @param verticalScrollDirection, vertical direction of the scroll.\r\n * @param horizontalScrollDirection, horizontal direction of the scroll.\r\n * @param scrollStep, scroll step in CSS pixels that would be applied in every loop.\r\n */\r\nfunction scrollToDirectionInterval$(scrollNode: HTMLElement | Window, verticalScrollDirection: AutoScrollVerticalDirection, horizontalScrollDirection: AutoScrollHorizontalDirection, scrollStep: number = 2) {\r\n    return interval(0, animationFrameScheduler)\r\n        .pipe(\r\n            tap(() => {\r\n                if (verticalScrollDirection === AutoScrollVerticalDirection.UP) {\r\n                    incrementVerticalScroll(scrollNode, -scrollStep);\r\n                } else if (verticalScrollDirection === AutoScrollVerticalDirection.DOWN) {\r\n                    incrementVerticalScroll(scrollNode, scrollStep);\r\n                }\r\n\r\n                if (horizontalScrollDirection === AutoScrollHorizontalDirection.LEFT) {\r\n                    incrementHorizontalScroll(scrollNode, -scrollStep);\r\n                } else if (horizontalScrollDirection === AutoScrollHorizontalDirection.RIGHT) {\r\n                    incrementHorizontalScroll(scrollNode, scrollStep);\r\n                }\r\n            }),\r\n            ktdNoEmit()\r\n        );\r\n}\r\n\r\nexport interface KtdScrollIfNearElementOptions {\r\n    scrollStep?: number;\r\n    disableVertical?: boolean;\r\n    disableHorizontal?: boolean;\r\n}\r\n\r\n/**\r\n * Given a source$ observable with pointer location, scroll the scrollNode if the pointer is near to it.\r\n * This observable doesn't emit, it just performs a 'scroll' side effect.\r\n * @param scrollableParent, parent node in which the scroll would be performed.\r\n * @param options, configuration options.\r\n */\r\nexport function ktdScrollIfNearElementClientRect$(scrollableParent: HTMLElement | Document, options?: KtdScrollIfNearElementOptions): (source$: Observable<{ pointerX: number, pointerY: number }>) => Observable<any> {\r\n\r\n    let scrollNode: Window | HTMLElement;\r\n    let scrollableParentClientRect: ClientRect;\r\n    let scrollableParentScrollWidth: number;\r\n\r\n    if (scrollableParent === document) {\r\n        scrollNode = document.defaultView as Window;\r\n        const {width, height} = getViewportSize();\r\n        scrollableParentClientRect = {width, height, top: 0, right: width, bottom: height, left: 0};\r\n        scrollableParentScrollWidth = getDocumentScrollWidth();\r\n    } else {\r\n        scrollNode = scrollableParent as HTMLElement;\r\n        scrollableParentClientRect = getMutableClientRect(scrollableParent as HTMLElement);\r\n        scrollableParentScrollWidth = (scrollableParent as HTMLElement).scrollWidth;\r\n    }\r\n\r\n    /**\r\n     * IMPORTANT: By design, only let scroll horizontal if the scrollable parent has explicitly an scroll horizontal.\r\n     * This layout solution is not designed in mind to have any scroll horizontal, but exceptionally we allow it in this\r\n     * specific use case.\r\n     */\r\n    options = options || {};\r\n    if (options.disableHorizontal == null && scrollableParentScrollWidth <= scrollableParentClientRect.width) {\r\n        options.disableHorizontal = true;\r\n    }\r\n\r\n    return (source$) => source$.pipe(\r\n        map(({pointerX, pointerY}) => {\r\n            let verticalScrollDirection = getVerticalScrollDirection(scrollableParentClientRect, pointerY);\r\n            let horizontalScrollDirection = getHorizontalScrollDirection(scrollableParentClientRect, pointerX);\r\n\r\n            // Check if scroll directions are disabled.\r\n            if (options?.disableVertical) {\r\n                verticalScrollDirection = AutoScrollVerticalDirection.NONE;\r\n            }\r\n            if (options?.disableHorizontal) {\r\n                horizontalScrollDirection = AutoScrollHorizontalDirection.NONE;\r\n            }\r\n\r\n            return {verticalScrollDirection, horizontalScrollDirection};\r\n        }),\r\n        distinctUntilChanged((prev, actual) => {\r\n            return prev.verticalScrollDirection === actual.verticalScrollDirection\r\n                && prev.horizontalScrollDirection === actual.horizontalScrollDirection;\r\n        }),\r\n        switchMap(({verticalScrollDirection, horizontalScrollDirection}) => {\r\n            if (verticalScrollDirection || horizontalScrollDirection) {\r\n                return scrollToDirectionInterval$(scrollNode, verticalScrollDirection, horizontalScrollDirection, options?.scrollStep);\r\n            } else {\r\n                return NEVER;\r\n            }\r\n        })\r\n    );\r\n}\r\n\r\n/**\r\n * Emits on EVERY scroll event and returns the accumulated scroll offset relative to the initial scroll position.\r\n * @param scrollableParent, node in which scroll events would be listened.\r\n */\r\nexport function ktdGetScrollTotalRelativeDifference$(scrollableParent: HTMLElement | Document): Observable<{ top: number, left: number }> {\r\n    let scrollInitialPosition;\r\n\r\n    // Calculate initial scroll position\r\n    if (scrollableParent === document) {\r\n        scrollInitialPosition = getViewportScrollPosition();\r\n    } else {\r\n        scrollInitialPosition = {\r\n            top: (scrollableParent as HTMLElement).scrollTop,\r\n            left: (scrollableParent as HTMLElement).scrollLeft\r\n        };\r\n    }\r\n\r\n    return fromEvent(scrollableParent, 'scroll', ktdNormalizePassiveListenerOptions({capture: true}) as AddEventListenerOptions).pipe(\r\n        map(() => {\r\n            let newTop: number;\r\n            let newLeft: number;\r\n\r\n            if (scrollableParent === document) {\r\n                const viewportScrollPosition = getViewportScrollPosition();\r\n                newTop = viewportScrollPosition.top;\r\n                newLeft = viewportScrollPosition.left;\r\n            } else {\r\n                newTop = (scrollableParent as HTMLElement).scrollTop;\r\n                newLeft = (scrollableParent as HTMLElement).scrollLeft;\r\n            }\r\n\r\n            const topDifference = scrollInitialPosition.top - newTop;\r\n            const leftDifference = scrollInitialPosition.left - newLeft;\r\n\r\n            return {top: topDifference, left: leftDifference};\r\n        })\r\n    );\r\n\r\n}\r\n\r\n/** Returns the viewport's width and height. */\r\nfunction getViewportSize(): { width: number, height: number } {\r\n    const _window = document.defaultView || window;\r\n    return {\r\n        width: _window.innerWidth,\r\n        height: _window.innerHeight\r\n    };\r\n\r\n}\r\n\r\n/** Gets a ClientRect for the viewport's bounds. */\r\nfunction getViewportRect(): ClientRect {\r\n    // Use the document element's bounding rect rather than the window scroll properties\r\n    // (e.g. pageYOffset, scrollY) due to in issue in Chrome and IE where window scroll\r\n    // properties and client coordinates (boundingClientRect, clientX/Y, etc.) are in different\r\n    // conceptual viewports. Under most circumstances these viewports are equivalent, but they\r\n    // can disagree when the page is pinch-zoomed (on devices that support touch).\r\n    // See https://bugs.chromium.org/p/chromium/issues/detail?id=489206#c4\r\n    // We use the documentElement instead of the body because, by default (without a css reset)\r\n    // browsers typically give the document body an 8px margin, which is not included in\r\n    // getBoundingClientRect().\r\n    const scrollPosition = getViewportScrollPosition();\r\n    const {width, height} = getViewportSize();\r\n\r\n    return {\r\n        top: scrollPosition.top,\r\n        left: scrollPosition.left,\r\n        bottom: scrollPosition.top + height,\r\n        right: scrollPosition.left + width,\r\n        height,\r\n        width,\r\n    };\r\n}\r\n\r\n/** Gets the (top, left) scroll position of the viewport. */\r\nfunction getViewportScrollPosition(): { top: number, left: number } {\r\n\r\n    // The top-left-corner of the viewport is determined by the scroll position of the document\r\n    // body, normally just (scrollLeft, scrollTop). However, Chrome and Firefox disagree about\r\n    // whether `document.body` or `document.documentElement` is the scrolled element, so reading\r\n    // `scrollTop` and `scrollLeft` is inconsistent. However, using the bounding rect of\r\n    // `document.documentElement` works consistently, where the `top` and `left` values will\r\n    // equal negative the scroll position.\r\n    const windowRef = document.defaultView || window;\r\n    const documentElement = document.documentElement!;\r\n    const documentRect = documentElement.getBoundingClientRect();\r\n\r\n    const top = -documentRect.top || document.body.scrollTop || windowRef.scrollY ||\r\n        documentElement.scrollTop || 0;\r\n\r\n    const left = -documentRect.left || document.body.scrollLeft || windowRef.scrollX ||\r\n        documentElement.scrollLeft || 0;\r\n\r\n    return {top, left};\r\n}\r\n\r\n/** Returns the document scroll width */\r\nfunction getDocumentScrollWidth() {\r\n    return Math.max(document.body.scrollWidth, document.documentElement.scrollWidth);\r\n}\r\n\r\n","import {\r\n    AfterContentChecked, AfterContentInit, ChangeDetectionStrategy, Component, ContentChildren, ElementRef, EventEmitter, Input, NgZone, OnChanges,\r\n    OnDestroy, Output, QueryList, Renderer2, SimpleChanges, ViewEncapsulation\r\n} from '@angular/core';\r\nimport { coerceNumberProperty, NumberInput } from './coercion/number-property';\r\nimport { KtdGridItemComponent } from './grid-item/grid-item.component';\r\nimport { combineLatest, merge, NEVER, Observable, Observer, of, Subscription } from 'rxjs';\r\nimport { exhaustMap, map, startWith, switchMap, takeUntil } from 'rxjs/operators';\r\nimport { ktdGridItemDragging, ktdGridItemResizing } from './utils/grid.utils';\r\nimport { compact, CompactType } from './utils/react-grid-layout.utils';\r\nimport {\r\n    GRID_ITEM_GET_RENDER_DATA_TOKEN, KtdDraggingData, KtdGridCfg, KtdGridCompactType, KtdGridItemRect, KtdGridItemRenderData, KtdGridLayout,\r\n    KtdGridLayoutItem\r\n} from './grid.definitions';\r\nimport { ktdMouseOrTouchEnd, ktdPointerClientX, ktdPointerClientY } from './utils/pointer.utils';\r\nimport { KtdDictionary } from '../types';\r\nimport { KtdGridService } from './grid.service';\r\nimport { getMutableClientRect } from './utils/client-rect';\r\nimport { ktdGetScrollTotalRelativeDifference$, ktdScrollIfNearElementClientRect$ } from './utils/scroll';\r\nimport { BooleanInput, coerceBooleanProperty } from './coercion/boolean-property';\r\n\r\ninterface KtdDragResizeEvent {\r\n    layout: KtdGridLayout;\r\n    layoutItem: KtdGridLayoutItem;\r\n    gridItemRef: KtdGridItemComponent;\r\n}\r\n\r\nexport type KtdDragStart = KtdDragResizeEvent;\r\nexport type KtdResizeStart = KtdDragResizeEvent;\r\nexport type KtdDragEnd = KtdDragResizeEvent;\r\nexport type KtdResizeEnd = KtdDragResizeEvent;\r\n\r\nfunction getDragResizeEventData(gridItem: KtdGridItemComponent, layout: KtdGridLayout): KtdDragResizeEvent {\r\n    return {\r\n        layout,\r\n        layoutItem: layout.find((item) => item.id === gridItem.id)!,\r\n        gridItemRef: gridItem\r\n    };\r\n}\r\n\r\n\r\nfunction layoutToRenderItems(config: KtdGridCfg, width: number, height: number): KtdDictionary<KtdGridItemRenderData<number>> {\r\n    const {cols, rowHeight, layout} = config;\r\n\r\n    const renderItems: KtdDictionary<KtdGridItemRenderData<number>> = {};\r\n    for (const item of layout) {\r\n        renderItems[item.id] = {\r\n            id: item.id,\r\n            top: item.y === 0 ? 0 : item.y * rowHeight,\r\n            left: item.x * (width / cols),\r\n            width: item.w * (width / cols),\r\n            height: item.h * rowHeight\r\n        };\r\n    }\r\n    return renderItems;\r\n}\r\n\r\nfunction getGridHeight(layout: KtdGridLayout, rowHeight: number): number {\r\n    return layout.reduce((acc, cur) => Math.max(acc, (cur.y + cur.h) * rowHeight), 0);\r\n}\r\n\r\n// tslint:disable-next-line\r\nexport function parseRenderItemToPixels(renderItem: KtdGridItemRenderData<number>): KtdGridItemRenderData<string> {\r\n    return {\r\n        id: renderItem.id,\r\n        top: `${renderItem.top}px`,\r\n        left: `${renderItem.left}px`,\r\n        width: `${renderItem.width}px`,\r\n        height: `${renderItem.height}px`\r\n    };\r\n}\r\n\r\n// tslint:disable-next-line:ktd-prefix-code\r\nexport function __gridItemGetRenderDataFactoryFunc(gridCmp: KtdGridComponent) {\r\n    // tslint:disable-next-line:only-arrow-functions\r\n    return function(id: string) {\r\n        return parseRenderItemToPixels(gridCmp.getItemRenderData(id));\r\n    };\r\n}\r\n\r\nexport function ktdGridItemGetRenderDataFactoryFunc(gridCmp: KtdGridComponent) {\r\n    // Workaround explained: https://github.com/ng-packagr/ng-packagr/issues/696#issuecomment-387114613\r\n    const resultFunc = __gridItemGetRenderDataFactoryFunc(gridCmp);\r\n    return resultFunc;\r\n}\r\n\r\n\r\n@Component({\r\n    selector: 'ktd-grid',\r\n    templateUrl: './grid.component.html',\r\n    styleUrls: ['./grid.component.scss'],\r\n    encapsulation: ViewEncapsulation.None,\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n    providers: [\r\n        {\r\n            provide: GRID_ITEM_GET_RENDER_DATA_TOKEN,\r\n            useFactory: ktdGridItemGetRenderDataFactoryFunc,\r\n            deps: [KtdGridComponent]\r\n        }\r\n    ]\r\n})\r\nexport class KtdGridComponent implements OnChanges, AfterContentInit, AfterContentChecked, OnDestroy {\r\n    /** Query list of grid items that are being rendered. */\r\n    @ContentChildren(KtdGridItemComponent, {descendants: true}) _gridItems: QueryList<KtdGridItemComponent>;\r\n\r\n    /** Emits when layout change */\r\n    @Output() layoutUpdated: EventEmitter<KtdGridLayout> = new EventEmitter<KtdGridLayout>();\r\n\r\n    /** Emits when drag starts */\r\n    @Output() dragStarted: EventEmitter<KtdDragStart> = new EventEmitter<KtdDragStart>();\r\n\r\n    /** Emits when resize starts */\r\n    @Output() resizeStarted: EventEmitter<KtdResizeStart> = new EventEmitter<KtdResizeStart>();\r\n\r\n    /** Emits when drag ends */\r\n    @Output() dragEnded: EventEmitter<KtdDragEnd> = new EventEmitter<KtdDragEnd>();\r\n\r\n    /** Emits when resize ends */\r\n    @Output() resizeEnded: EventEmitter<KtdResizeEnd> = new EventEmitter<KtdResizeEnd>();\r\n\r\n    /**\r\n     * Parent element that contains the scroll. If an string is provided it would search that element by id on the dom.\r\n     * If no data provided or null autoscroll is not performed.\r\n     */\r\n    @Input() scrollableParent: HTMLElement | Document | string | null = null;\r\n\r\n    /** Whether or not to update the internal layout when some dependent property change. */\r\n    @Input()\r\n    get compactOnPropsChange(): boolean { return this._compactOnPropsChange; }\r\n\r\n    set compactOnPropsChange(value: boolean) {\r\n        this._compactOnPropsChange = coerceBooleanProperty(value);\r\n    }\r\n\r\n    private _compactOnPropsChange: boolean = true;\r\n\r\n    /** If true, grid items won't change position when being dragged over. Handy when using no compaction */\r\n    @Input()\r\n    get preventCollision(): boolean { return this._preventCollision; }\r\n\r\n    set preventCollision(value: boolean) {\r\n        this._preventCollision = coerceBooleanProperty(value);\r\n    }\r\n\r\n    private _preventCollision: boolean = false;\r\n\r\n    /** Number of CSS pixels that would be scrolled on each 'tick' when auto scroll is performed. */\r\n    @Input()\r\n    get scrollSpeed(): number { return this._scrollSpeed; }\r\n\r\n    set scrollSpeed(value: number) {\r\n        this._scrollSpeed = coerceNumberProperty(value, 2);\r\n    }\r\n\r\n    private _scrollSpeed: number = 2;\r\n\r\n    /** Type of compaction that will be applied to the layout (vertical, horizontal or free). Defaults to 'vertical' */\r\n    @Input()\r\n    get compactType(): KtdGridCompactType {\r\n        return this._compactType;\r\n    }\r\n\r\n    set compactType(val: KtdGridCompactType) {\r\n        this._compactType = val;\r\n    }\r\n\r\n    private _compactType: KtdGridCompactType = 'vertical';\r\n\r\n    /** Row height in css pixels */\r\n    @Input()\r\n    get rowHeight(): number { return this._rowHeight; }\r\n\r\n    set rowHeight(val: number) {\r\n        this._rowHeight = Math.max(1, Math.round(coerceNumberProperty(val)));\r\n    }\r\n\r\n    private _rowHeight: number = 100;\r\n\r\n    /** Number of columns  */\r\n    @Input()\r\n    get cols(): number { return this._cols; }\r\n\r\n    set cols(val: number) {\r\n        this._cols = Math.max(1, Math.round(coerceNumberProperty(val)));\r\n    }\r\n\r\n    private _cols: number = 6;\r\n\r\n    /** Layout of the grid. Array of all the grid items with its 'id' and position on the grid. */\r\n    @Input()\r\n    get layout(): KtdGridLayout { return this._layout; }\r\n\r\n    set layout(layout: KtdGridLayout) {\r\n        /**\r\n         * Enhancement:\r\n         * Only set layout if it's reference has changed and use a boolean to track whenever recalculate the layout on ngOnChanges.\r\n         *\r\n         * Why:\r\n         * The normal use of this lib is having the variable layout in the outer component or in a store, assigning it whenever it changes and\r\n         * binded in the component with it's input [layout]. In this scenario, we would always calculate one unnecessary change on the layout when\r\n         * it is re-binded on the input.\r\n         */\r\n        this._layout = layout;\r\n    }\r\n\r\n    private _layout: KtdGridLayout;\r\n\r\n    get config(): KtdGridCfg {\r\n        return {\r\n            cols: this.cols,\r\n            rowHeight: this.rowHeight,\r\n            layout: this.layout,\r\n            preventCollision: this.preventCollision,\r\n        };\r\n    }\r\n\r\n    /** Total height of the grid */\r\n    private _height: number;\r\n    private _gridItemsRenderData: KtdDictionary<KtdGridItemRenderData<number>>;\r\n    private subscriptions: Subscription[];\r\n\r\n    constructor(private gridService: KtdGridService,\r\n                private elementRef: ElementRef,\r\n                private renderer: Renderer2,\r\n                private ngZone: NgZone) {\r\n\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        let needsCompactLayout = false;\r\n        let needsRecalculateRenderData = false;\r\n\r\n        // TODO: Does fist change need to be compacted by default?\r\n        // Compact layout whenever some dependent prop changes.\r\n        if (changes.compactType || changes.cols || changes.layout) {\r\n            needsCompactLayout = true;\r\n        }\r\n\r\n        // Check if wee need to recalculate rendering data.\r\n        if (needsCompactLayout || changes.rowHeight) {\r\n            needsRecalculateRenderData = true;\r\n        }\r\n\r\n        // Only compact layout if lib user has provided it. Lib users that want to save/store always the same layout  as it is represented (compacted)\r\n        // can use KtdCompactGrid utility and pre-compact the layout. This is the recommended behaviour for always having a the same layout on this component\r\n        // and the ones that uses it.\r\n        if (needsCompactLayout && this.compactOnPropsChange) {\r\n            this.compactLayout();\r\n        }\r\n\r\n        if (needsRecalculateRenderData) {\r\n            this.calculateRenderData();\r\n        }\r\n    }\r\n\r\n    ngAfterContentInit() {\r\n        this.initSubscriptions();\r\n    }\r\n\r\n    ngAfterContentChecked() {\r\n        this.render();\r\n    }\r\n\r\n    resize() {\r\n        this.calculateRenderData();\r\n        this.render();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.subscriptions.forEach(sub => sub.unsubscribe());\r\n    }\r\n\r\n    compactLayout() {\r\n        this.layout = compact(this.layout, this.compactType, this.cols);\r\n    }\r\n\r\n    getItemsRenderData(): KtdDictionary<KtdGridItemRenderData<number>> {\r\n        return {...this._gridItemsRenderData};\r\n    }\r\n\r\n    getItemRenderData(itemId: string): KtdGridItemRenderData<number> {\r\n        return this._gridItemsRenderData[itemId];\r\n    }\r\n\r\n    calculateRenderData() {\r\n        const clientRect = (this.elementRef.nativeElement as HTMLElement).getBoundingClientRect();\r\n        this._gridItemsRenderData = layoutToRenderItems(this.config, clientRect.width, clientRect.height);\r\n        this._height = getGridHeight(this.layout, this.rowHeight);\r\n    }\r\n\r\n    render() {\r\n        this.renderer.setStyle(this.elementRef.nativeElement, 'height', `${this._height}px`);\r\n        this.updateGridItemsStyles();\r\n    }\r\n\r\n    private updateGridItemsStyles() {\r\n        this._gridItems.forEach(item => {\r\n            const gridItemRenderData: KtdGridItemRenderData<number> | undefined = this._gridItemsRenderData[item.id];\r\n            if (gridItemRenderData == null) {\r\n                console.error(`Couldn\\'t find the specified grid item for the id: ${item.id}`);\r\n            } else {\r\n                item.setStyles(parseRenderItemToPixels(gridItemRenderData));\r\n            }\r\n        });\r\n    }\r\n\r\n    private initSubscriptions() {\r\n        this.subscriptions = [\r\n            this._gridItems.changes.pipe(\r\n                startWith(this._gridItems),\r\n                switchMap((gridItems: QueryList<KtdGridItemComponent>) => {\r\n                    return merge(\r\n                        ...gridItems.map((gridItem) => gridItem.dragStart$.pipe(map((event) => ({event, gridItem, type: 'drag'})))),\r\n                        ...gridItems.map((gridItem) => gridItem.resizeStart$.pipe(map((event) => ({event, gridItem, type: 'resize'})))),\r\n                    ).pipe(exhaustMap(({event, gridItem, type}) => {\r\n                        // Emit drag or resize start events. Ensure that is start event is inside the zone.\r\n                        this.ngZone.run(() => (type === 'drag' ? this.dragStarted : this.resizeStarted).emit(getDragResizeEventData(gridItem, this.layout)));\r\n                        // Get the correct newStateFunc depending on if we are dragging or resizing\r\n                        const calcNewStateFunc = type === 'drag' ? ktdGridItemDragging : ktdGridItemResizing;\r\n\r\n                        // Perform drag sequence\r\n                        return this.performDragSequence$(gridItem, event, (gridItemId, config, compactionType, draggingData) =>\r\n                            calcNewStateFunc(gridItem, config, compactionType, draggingData)\r\n                        ).pipe(map((layout) => ({layout, gridItem, type})));\r\n\r\n                    }));\r\n                })\r\n            ).subscribe(({layout, gridItem, type}) => {\r\n                this.layout = layout;\r\n                // Calculate new rendering data given the new layout.\r\n                this.calculateRenderData();\r\n                // Emit drag or resize end events.\r\n                (type === 'drag' ? this.dragEnded : this.resizeEnded).emit(getDragResizeEventData(gridItem, layout));\r\n                // Notify that the layout has been updated.\r\n                this.layoutUpdated.emit(layout);\r\n            })\r\n\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * Perform a general grid drag action, from start to end. A general grid drag action basically includes creating the placeholder element and adding\r\n     * some class animations. calcNewStateFunc needs to be provided in order to calculate the new state of the layout.\r\n     * @param gridItem that is been dragged\r\n     * @param pointerDownEvent event (mousedown or touchdown) where the user initiated the drag\r\n     * @param calcNewStateFunc function that return the new layout state and the drag element position\r\n     */\r\n    private performDragSequence$(gridItem: KtdGridItemComponent, pointerDownEvent: MouseEvent | TouchEvent,\r\n                                 calcNewStateFunc: (gridItem: KtdGridItemComponent, config: KtdGridCfg, compactionType: CompactType, draggingData: KtdDraggingData) => { layout: KtdGridLayoutItem[]; draggedItemPos: KtdGridItemRect }): Observable<KtdGridLayout> {\r\n\r\n        return new Observable<KtdGridLayout>((observer: Observer<KtdGridLayout>) => {\r\n            // Retrieve grid (parent) and gridItem (draggedElem) client rects.\r\n            const gridElemClientRect: ClientRect = getMutableClientRect(this.elementRef.nativeElement as HTMLElement);\r\n            const dragElemClientRect: ClientRect = getMutableClientRect(gridItem.elementRef.nativeElement as HTMLElement);\r\n\r\n            const scrollableParent = typeof this.scrollableParent === 'string' ? document.getElementById(this.scrollableParent) : this.scrollableParent;\r\n\r\n            this.renderer.addClass(gridItem.elementRef.nativeElement, 'no-transitions');\r\n            this.renderer.addClass(gridItem.elementRef.nativeElement, 'ktd-grid-item-dragging');\r\n\r\n            // Create placeholder element. This element would represent the position where the dragged/resized element would be if the action ends\r\n            const placeholderElement: HTMLDivElement = this.renderer.createElement('div');\r\n            placeholderElement.style.width = `${dragElemClientRect.width}px`;\r\n            placeholderElement.style.height = `${dragElemClientRect.height}px`;\r\n            placeholderElement.style.transform = `translateX(${dragElemClientRect.left - gridElemClientRect.left}px) translateY(${dragElemClientRect.top - gridElemClientRect.top}px)`;\r\n\r\n            this.renderer.addClass(placeholderElement, 'ktd-grid-item-placeholder');\r\n            this.renderer.appendChild(this.elementRef.nativeElement, placeholderElement);\r\n\r\n            let newLayout: KtdGridLayoutItem[];\r\n\r\n            // TODO (enhancement): consider move this 'side effect' observable inside the main drag loop.\r\n            //  - Pros are that we would not repeat subscriptions and takeUntil would shut down observables at the same time.\r\n            //  - Cons are that moving this functionality as a side effect inside the main drag loop would be confusing.\r\n            const scrollSubscription = this.ngZone.runOutsideAngular(() =>\r\n                (!scrollableParent ? NEVER : this.gridService.mouseOrTouchMove$(document).pipe(\r\n                    map((event) => ({\r\n                        pointerX: ktdPointerClientX(event),\r\n                        pointerY: ktdPointerClientY(event)\r\n                    })),\r\n                    ktdScrollIfNearElementClientRect$(scrollableParent, {scrollStep: this.scrollSpeed})\r\n                )).pipe(\r\n                    takeUntil(ktdMouseOrTouchEnd(document))\r\n                ).subscribe());\r\n\r\n            /**\r\n             * Main subscription, it listens for 'pointer move' and 'scroll' events and recalculates the layout on each emission\r\n             */\r\n            const subscription = this.ngZone.runOutsideAngular(() =>\r\n                merge(\r\n                    combineLatest([\r\n                        this.gridService.mouseOrTouchMove$(document),\r\n                        ...(!scrollableParent ? [of({top: 0, left: 0})] : [\r\n                            ktdGetScrollTotalRelativeDifference$(scrollableParent).pipe(\r\n                                startWith({top: 0, left: 0}) // Force first emission to allow CombineLatest to emit even no scroll event has occurred\r\n                            )\r\n                        ])\r\n                    ])\r\n                ).pipe(\r\n                    takeUntil(ktdMouseOrTouchEnd(document)),\r\n                ).subscribe(([pointerDragEvent, scrollDifference]: [MouseEvent | TouchEvent, { top: number, left: number }]) => {\r\n                        pointerDragEvent.preventDefault();\r\n\r\n                        /**\r\n                         * Set the new layout to be the layout in which the calcNewStateFunc would be executed.\r\n                         * NOTE: using the mutated layout is the way to go by 'react-grid-layout' utils. If we don't use the previous layout,\r\n                         * some utilities from 'react-grid-layout' would not work as expected.\r\n                         */\r\n                        const currentLayout: KtdGridLayout = newLayout || this.layout;\r\n\r\n                        const {layout, draggedItemPos} = calcNewStateFunc(gridItem, {\r\n                            layout: currentLayout,\r\n                            rowHeight: this.rowHeight,\r\n                            cols: this.cols,\r\n                            preventCollision: this.preventCollision\r\n                        }, this.compactType, {\r\n                            pointerDownEvent,\r\n                            pointerDragEvent,\r\n                            gridElemClientRect,\r\n                            dragElemClientRect,\r\n                            scrollDifference\r\n                        });\r\n                        newLayout = layout;\r\n\r\n                        this._height = getGridHeight(newLayout, this.rowHeight);\r\n\r\n                        this._gridItemsRenderData = layoutToRenderItems({\r\n                            cols: this.cols,\r\n                            rowHeight: this.rowHeight,\r\n                            layout: newLayout,\r\n                            preventCollision: this.preventCollision,\r\n                        }, gridElemClientRect.width, gridElemClientRect.height);\r\n\r\n                        const placeholderStyles = parseRenderItemToPixels(this._gridItemsRenderData[gridItem.id]);\r\n\r\n                        // Put the real final position to the placeholder element\r\n                        placeholderElement.style.width = placeholderStyles.width;\r\n                        placeholderElement.style.height = placeholderStyles.height;\r\n                        placeholderElement.style.transform = `translateX(${placeholderStyles.left}) translateY(${placeholderStyles.top})`;\r\n\r\n                        // modify the position of the dragged item to be the once we want (for example the mouse position or whatever)\r\n                        this._gridItemsRenderData[gridItem.id] = {\r\n                            ...draggedItemPos,\r\n                            id: this._gridItemsRenderData[gridItem.id].id\r\n                        };\r\n\r\n                        this.render();\r\n                    },\r\n                    (error) => observer.error(error),\r\n                    () => {\r\n                        this.ngZone.run(() => {\r\n                            // Remove drag classes\r\n                            this.renderer.removeClass(gridItem.elementRef.nativeElement, 'no-transitions');\r\n                            this.renderer.removeClass(gridItem.elementRef.nativeElement, 'ktd-grid-item-dragging');\r\n\r\n                            // Remove placeholder element from the dom\r\n                            // NOTE: If we don't put the removeChild inside the zone it would not work... This may be a bug from angular or maybe is the intended behaviour, although strange.\r\n                            // It should work since AFAIK this action should not be done in a CD cycle.\r\n                            this.renderer.removeChild(this.elementRef.nativeElement, placeholderElement);\r\n\r\n                            if (newLayout) {\r\n                                // TODO: newLayout should already be pruned. If not, it should have type Layout, not KtdGridLayout as it is now.\r\n                                // Prune react-grid-layout compact extra properties.\r\n                                observer.next(newLayout.map(item => ({\r\n                                    id: item.id,\r\n                                    x: item.x,\r\n                                    y: item.y,\r\n                                    w: item.w,\r\n                                    h: item.h,\r\n                                    minW: item.minW,\r\n                                    minH: item.minH,\r\n                                    maxW: item.maxW,\r\n                                    maxH: item.maxH,\r\n                                })) as KtdGridLayout);\r\n                            } else {\r\n                                // TODO: Need we really to emit if there is no layout change but drag started and ended?\r\n                                observer.next(this.layout);\r\n                            }\r\n\r\n                            observer.complete();\r\n                        });\r\n\r\n                    }));\r\n\r\n\r\n            return () => {\r\n                scrollSubscription.unsubscribe();\r\n                subscription.unsubscribe();\r\n            };\r\n        });\r\n    }\r\n\r\n\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_cols: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_rowHeight: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_scrollSpeed: NumberInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_compactOnPropsChange: BooleanInput;\r\n    // tslint:disable-next-line\r\n    static ngAcceptInputType_preventCollision: BooleanInput;\r\n}\r\n\r\n","<ng-content></ng-content>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { KtdGridComponent } from './grid.component';\r\nimport { KtdGridItemComponent } from './grid-item/grid-item.component';\r\nimport { KtdGridDragHandle } from './directives/drag-handle';\r\nimport { KtdGridResizeHandle } from './directives/resize-handle';\r\nimport { KtdGridService } from './grid.service';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        KtdGridComponent,\r\n        KtdGridItemComponent,\r\n        KtdGridDragHandle,\r\n        KtdGridResizeHandle\r\n    ],\r\n    exports: [\r\n        KtdGridComponent,\r\n        KtdGridItemComponent,\r\n        KtdGridDragHandle,\r\n        KtdGridResizeHandle\r\n    ],\r\n    providers: [\r\n        KtdGridService\r\n    ],\r\n    imports: [\r\n        CommonModule\r\n    ]\r\n})\r\nexport class KtdGridModule {}\r\n","/*\r\n * Public API Surface of grid\r\n */\r\nexport { ktdGridCompact, ktdTrackById } from './lib/utils/grid.utils';\r\nexport * from './lib/directives/drag-handle';\r\nexport * from './lib/directives/resize-handle';\r\nexport * from './lib/grid-item/grid-item.component';\r\nexport * from './lib/grid.definitions';\r\nexport * from './lib/grid.component';\r\nexport * from './lib/grid.module';\r\n\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}